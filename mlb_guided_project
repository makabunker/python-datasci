{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "# Guided Project: Designing and Creating a Database"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import sqlite3\n",
    "import csv\n",
    "pd.set_option('max_columns', 180)\n",
    "pd.set_option('max_rows', 200000)\n",
    "pd.set_option('max_colwidth', 5000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "game_log = pd.read_csv('game_log.csv', low_memory=False)\n",
    "park_codes = pd.read_csv('park_codes.csv')\n",
    "person_codes = pd.read_csv('person_codes.csv')\n",
    "team_codes = pd.read_csv('team_codes.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(171907, 161)"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "game_log.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>number_of_game</th>\n",
       "      <th>day_of_week</th>\n",
       "      <th>v_name</th>\n",
       "      <th>v_league</th>\n",
       "      <th>v_game_number</th>\n",
       "      <th>h_name</th>\n",
       "      <th>h_league</th>\n",
       "      <th>h_game_number</th>\n",
       "      <th>v_score</th>\n",
       "      <th>h_score</th>\n",
       "      <th>length_outs</th>\n",
       "      <th>day_night</th>\n",
       "      <th>completion</th>\n",
       "      <th>forefeit</th>\n",
       "      <th>protest</th>\n",
       "      <th>park_id</th>\n",
       "      <th>attendance</th>\n",
       "      <th>length_minutes</th>\n",
       "      <th>v_line_score</th>\n",
       "      <th>h_line_score</th>\n",
       "      <th>v_at_bats</th>\n",
       "      <th>v_hits</th>\n",
       "      <th>v_doubles</th>\n",
       "      <th>v_triples</th>\n",
       "      <th>v_homeruns</th>\n",
       "      <th>v_rbi</th>\n",
       "      <th>v_sacrifice_hits</th>\n",
       "      <th>v_sacrifice_flies</th>\n",
       "      <th>v_hit_by_pitch</th>\n",
       "      <th>v_walks</th>\n",
       "      <th>v_intentional_walks</th>\n",
       "      <th>v_strikeouts</th>\n",
       "      <th>v_stolen_bases</th>\n",
       "      <th>v_caught_stealing</th>\n",
       "      <th>v_grounded_into_double</th>\n",
       "      <th>v_first_catcher_interference</th>\n",
       "      <th>v_left_on_base</th>\n",
       "      <th>v_pitchers_used</th>\n",
       "      <th>v_individual_earned_runs</th>\n",
       "      <th>v_team_earned_runs</th>\n",
       "      <th>v_wild_pitches</th>\n",
       "      <th>v_balks</th>\n",
       "      <th>v_putouts</th>\n",
       "      <th>v_assists</th>\n",
       "      <th>v_errors</th>\n",
       "      <th>v_passed_balls</th>\n",
       "      <th>v_double_plays</th>\n",
       "      <th>v_triple_plays</th>\n",
       "      <th>h_at_bats</th>\n",
       "      <th>h_hits</th>\n",
       "      <th>h_doubles</th>\n",
       "      <th>h_triples</th>\n",
       "      <th>h_homeruns</th>\n",
       "      <th>h_rbi</th>\n",
       "      <th>h_sacrifice_hits</th>\n",
       "      <th>h_sacrifice_flies</th>\n",
       "      <th>h_hit_by_pitch</th>\n",
       "      <th>h_walks</th>\n",
       "      <th>h_intentional_walks</th>\n",
       "      <th>h_strikeouts</th>\n",
       "      <th>h_stolen_bases</th>\n",
       "      <th>h_caught_stealing</th>\n",
       "      <th>h_grounded_into_double</th>\n",
       "      <th>h_first_catcher_interference</th>\n",
       "      <th>h_left_on_base</th>\n",
       "      <th>h_pitchers_used</th>\n",
       "      <th>h_individual_earned_runs</th>\n",
       "      <th>h_team_earned_runs</th>\n",
       "      <th>h_wild_pitches</th>\n",
       "      <th>h_balks</th>\n",
       "      <th>h_putouts</th>\n",
       "      <th>h_assists</th>\n",
       "      <th>h_errors</th>\n",
       "      <th>h_passed_balls</th>\n",
       "      <th>h_double_plays</th>\n",
       "      <th>h_triple_plays</th>\n",
       "      <th>hp_umpire_id</th>\n",
       "      <th>hp_umpire_name</th>\n",
       "      <th>1b_umpire_id</th>\n",
       "      <th>1b_umpire_name</th>\n",
       "      <th>2b_umpire_id</th>\n",
       "      <th>2b_umpire_name</th>\n",
       "      <th>3b_umpire_id</th>\n",
       "      <th>3b_umpire_name</th>\n",
       "      <th>lf_umpire_id</th>\n",
       "      <th>lf_umpire_name</th>\n",
       "      <th>rf_umpire_id</th>\n",
       "      <th>rf_umpire_name</th>\n",
       "      <th>v_manager_id</th>\n",
       "      <th>v_manager_name</th>\n",
       "      <th>h_manager_id</th>\n",
       "      <th>h_manager_name</th>\n",
       "      <th>winning_pitcher_id</th>\n",
       "      <th>winning_pitcher_name</th>\n",
       "      <th>losing_pitcher_id</th>\n",
       "      <th>losing_pitcher_name</th>\n",
       "      <th>saving_pitcher_id</th>\n",
       "      <th>saving_pitcher_name</th>\n",
       "      <th>winning_rbi_batter_id</th>\n",
       "      <th>winning_rbi_batter_id_name</th>\n",
       "      <th>v_starting_pitcher_id</th>\n",
       "      <th>v_starting_pitcher_name</th>\n",
       "      <th>h_starting_pitcher_id</th>\n",
       "      <th>h_starting_pitcher_name</th>\n",
       "      <th>v_player_1_id</th>\n",
       "      <th>v_player_1_name</th>\n",
       "      <th>v_player_1_def_pos</th>\n",
       "      <th>v_player_2_id</th>\n",
       "      <th>v_player_2_name</th>\n",
       "      <th>v_player_2_def_pos</th>\n",
       "      <th>v_player_3_id</th>\n",
       "      <th>v_player_3_name</th>\n",
       "      <th>v_player_3_def_pos</th>\n",
       "      <th>v_player_4_id</th>\n",
       "      <th>v_player_4_name</th>\n",
       "      <th>v_player_4_def_pos</th>\n",
       "      <th>v_player_5_id</th>\n",
       "      <th>v_player_5_name</th>\n",
       "      <th>v_player_5_def_pos</th>\n",
       "      <th>v_player_6_id</th>\n",
       "      <th>v_player_6_name</th>\n",
       "      <th>v_player_6_def_pos</th>\n",
       "      <th>v_player_7_id</th>\n",
       "      <th>v_player_7_name</th>\n",
       "      <th>v_player_7_def_pos</th>\n",
       "      <th>v_player_8_id</th>\n",
       "      <th>v_player_8_name</th>\n",
       "      <th>v_player_8_def_pos</th>\n",
       "      <th>v_player_9_id</th>\n",
       "      <th>v_player_9_name</th>\n",
       "      <th>v_player_9_def_pos</th>\n",
       "      <th>h_player_1_id</th>\n",
       "      <th>h_player_1_name</th>\n",
       "      <th>h_player_1_def_pos</th>\n",
       "      <th>h_player_2_id</th>\n",
       "      <th>h_player_2_name</th>\n",
       "      <th>h_player_2_def_pos</th>\n",
       "      <th>h_player_3_id</th>\n",
       "      <th>h_player_3_name</th>\n",
       "      <th>h_player_3_def_pos</th>\n",
       "      <th>h_player_4_id</th>\n",
       "      <th>h_player_4_name</th>\n",
       "      <th>h_player_4_def_pos</th>\n",
       "      <th>h_player_5_id</th>\n",
       "      <th>h_player_5_name</th>\n",
       "      <th>h_player_5_def_pos</th>\n",
       "      <th>h_player_6_id</th>\n",
       "      <th>h_player_6_name</th>\n",
       "      <th>h_player_6_def_pos</th>\n",
       "      <th>h_player_7_id</th>\n",
       "      <th>h_player_7_name</th>\n",
       "      <th>h_player_7_def_pos</th>\n",
       "      <th>h_player_8_id</th>\n",
       "      <th>h_player_8_name</th>\n",
       "      <th>h_player_8_def_pos</th>\n",
       "      <th>h_player_9_id</th>\n",
       "      <th>h_player_9_name</th>\n",
       "      <th>h_player_9_def_pos</th>\n",
       "      <th>additional_info</th>\n",
       "      <th>acquisition_info</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>18710504</td>\n",
       "      <td>0</td>\n",
       "      <td>Thu</td>\n",
       "      <td>CL1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>FW1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FOR01</td>\n",
       "      <td>200.0</td>\n",
       "      <td>120.0</td>\n",
       "      <td>000000000</td>\n",
       "      <td>010010000</td>\n",
       "      <td>30.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>boakj901</td>\n",
       "      <td>John Boake</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>lennb101</td>\n",
       "      <td>Bill Lennon</td>\n",
       "      <td>mathb101</td>\n",
       "      <td>Bobby Mathews</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>mathb101</td>\n",
       "      <td>Bobby Mathews</td>\n",
       "      <td>whitd102</td>\n",
       "      <td>Deacon White</td>\n",
       "      <td>2.0</td>\n",
       "      <td>kimbg101</td>\n",
       "      <td>Gene Kimball</td>\n",
       "      <td>4.0</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>7.0</td>\n",
       "      <td>allia101</td>\n",
       "      <td>Art Allison</td>\n",
       "      <td>8.0</td>\n",
       "      <td>white104</td>\n",
       "      <td>Elmer White</td>\n",
       "      <td>9.0</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>1.0</td>\n",
       "      <td>sutte101</td>\n",
       "      <td>Ezra Sutton</td>\n",
       "      <td>5.0</td>\n",
       "      <td>carlj102</td>\n",
       "      <td>Jim Carleton</td>\n",
       "      <td>3.0</td>\n",
       "      <td>bassj101</td>\n",
       "      <td>John Bass</td>\n",
       "      <td>6.0</td>\n",
       "      <td>selmf101</td>\n",
       "      <td>Frank Sellman</td>\n",
       "      <td>5.0</td>\n",
       "      <td>mathb101</td>\n",
       "      <td>Bobby Mathews</td>\n",
       "      <td>1.0</td>\n",
       "      <td>foraj101</td>\n",
       "      <td>Jim Foran</td>\n",
       "      <td>3.0</td>\n",
       "      <td>goldw101</td>\n",
       "      <td>Wally Goldsmith</td>\n",
       "      <td>6.0</td>\n",
       "      <td>lennb101</td>\n",
       "      <td>Bill Lennon</td>\n",
       "      <td>2.0</td>\n",
       "      <td>caret101</td>\n",
       "      <td>Tom Carey</td>\n",
       "      <td>4.0</td>\n",
       "      <td>mince101</td>\n",
       "      <td>Ed Mincher</td>\n",
       "      <td>7.0</td>\n",
       "      <td>mcdej101</td>\n",
       "      <td>James McDermott</td>\n",
       "      <td>8.0</td>\n",
       "      <td>kellb105</td>\n",
       "      <td>Bill Kelly</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>18710505</td>\n",
       "      <td>0</td>\n",
       "      <td>Fri</td>\n",
       "      <td>BS1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>WS3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>20</td>\n",
       "      <td>18</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>WAS01</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>107000435</td>\n",
       "      <td>640113030</td>\n",
       "      <td>41.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>dobsh901</td>\n",
       "      <td>Henry Dobson</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>younn801</td>\n",
       "      <td>Nick Young</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>braia102</td>\n",
       "      <td>Asa Brainard</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>braia102</td>\n",
       "      <td>Asa Brainard</td>\n",
       "      <td>wrigg101</td>\n",
       "      <td>George Wright</td>\n",
       "      <td>6.0</td>\n",
       "      <td>barnr102</td>\n",
       "      <td>Ross Barnes</td>\n",
       "      <td>4.0</td>\n",
       "      <td>birdd102</td>\n",
       "      <td>Dave Birdsall</td>\n",
       "      <td>9.0</td>\n",
       "      <td>mcvec101</td>\n",
       "      <td>Cal McVey</td>\n",
       "      <td>2.0</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>8.0</td>\n",
       "      <td>goulc101</td>\n",
       "      <td>Charlie Gould</td>\n",
       "      <td>3.0</td>\n",
       "      <td>schah101</td>\n",
       "      <td>Harry Schafer</td>\n",
       "      <td>5.0</td>\n",
       "      <td>conef101</td>\n",
       "      <td>Fred Cone</td>\n",
       "      <td>7.0</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>1.0</td>\n",
       "      <td>watef102</td>\n",
       "      <td>Fred Waterman</td>\n",
       "      <td>5.0</td>\n",
       "      <td>forcd101</td>\n",
       "      <td>Davy Force</td>\n",
       "      <td>6.0</td>\n",
       "      <td>mille105</td>\n",
       "      <td>Everett Mills</td>\n",
       "      <td>3.0</td>\n",
       "      <td>allid101</td>\n",
       "      <td>Doug Allison</td>\n",
       "      <td>2.0</td>\n",
       "      <td>hallg101</td>\n",
       "      <td>George Hall</td>\n",
       "      <td>7.0</td>\n",
       "      <td>leona101</td>\n",
       "      <td>Andy Leonard</td>\n",
       "      <td>4.0</td>\n",
       "      <td>braia102</td>\n",
       "      <td>Asa Brainard</td>\n",
       "      <td>1.0</td>\n",
       "      <td>burrh101</td>\n",
       "      <td>Henry Burroughs</td>\n",
       "      <td>9.0</td>\n",
       "      <td>berth101</td>\n",
       "      <td>Henry Berthrong</td>\n",
       "      <td>8.0</td>\n",
       "      <td>HTBF</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>18710506</td>\n",
       "      <td>0</td>\n",
       "      <td>Sat</td>\n",
       "      <td>CL1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>RC1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>RCK01</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>610020003</td>\n",
       "      <td>010020100</td>\n",
       "      <td>49.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>mawnj901</td>\n",
       "      <td>J.H. Manny</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>hasts101</td>\n",
       "      <td>Scott Hastings</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>fishc102</td>\n",
       "      <td>Cherokee Fisher</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>fishc102</td>\n",
       "      <td>Cherokee Fisher</td>\n",
       "      <td>whitd102</td>\n",
       "      <td>Deacon White</td>\n",
       "      <td>2.0</td>\n",
       "      <td>kimbg101</td>\n",
       "      <td>Gene Kimball</td>\n",
       "      <td>4.0</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>7.0</td>\n",
       "      <td>allia101</td>\n",
       "      <td>Art Allison</td>\n",
       "      <td>8.0</td>\n",
       "      <td>white104</td>\n",
       "      <td>Elmer White</td>\n",
       "      <td>9.0</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>1.0</td>\n",
       "      <td>sutte101</td>\n",
       "      <td>Ezra Sutton</td>\n",
       "      <td>5.0</td>\n",
       "      <td>carlj102</td>\n",
       "      <td>Jim Carleton</td>\n",
       "      <td>3.0</td>\n",
       "      <td>bassj101</td>\n",
       "      <td>John Bass</td>\n",
       "      <td>6.0</td>\n",
       "      <td>mackd101</td>\n",
       "      <td>Denny Mack</td>\n",
       "      <td>3.0</td>\n",
       "      <td>addyb101</td>\n",
       "      <td>Bob Addy</td>\n",
       "      <td>4.0</td>\n",
       "      <td>fishc102</td>\n",
       "      <td>Cherokee Fisher</td>\n",
       "      <td>1.0</td>\n",
       "      <td>hasts101</td>\n",
       "      <td>Scott Hastings</td>\n",
       "      <td>8.0</td>\n",
       "      <td>ham-r101</td>\n",
       "      <td>Ralph Ham</td>\n",
       "      <td>5.0</td>\n",
       "      <td>ansoc101</td>\n",
       "      <td>Cap Anson</td>\n",
       "      <td>2.0</td>\n",
       "      <td>sagep101</td>\n",
       "      <td>Pony Sager</td>\n",
       "      <td>6.0</td>\n",
       "      <td>birdg101</td>\n",
       "      <td>George Bird</td>\n",
       "      <td>7.0</td>\n",
       "      <td>stirg101</td>\n",
       "      <td>Gat Stires</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>18710508</td>\n",
       "      <td>0</td>\n",
       "      <td>Mon</td>\n",
       "      <td>CL1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "      <td>CH1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>14</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CHI01</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>101403111</td>\n",
       "      <td>077000000</td>\n",
       "      <td>46.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>willg901</td>\n",
       "      <td>Gardner Willard</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>woodj106</td>\n",
       "      <td>Jimmy Wood</td>\n",
       "      <td>zettg101</td>\n",
       "      <td>George Zettlein</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>zettg101</td>\n",
       "      <td>George Zettlein</td>\n",
       "      <td>whitd102</td>\n",
       "      <td>Deacon White</td>\n",
       "      <td>2.0</td>\n",
       "      <td>kimbg101</td>\n",
       "      <td>Gene Kimball</td>\n",
       "      <td>4.0</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>7.0</td>\n",
       "      <td>allia101</td>\n",
       "      <td>Art Allison</td>\n",
       "      <td>8.0</td>\n",
       "      <td>white104</td>\n",
       "      <td>Elmer White</td>\n",
       "      <td>9.0</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>1.0</td>\n",
       "      <td>sutte101</td>\n",
       "      <td>Ezra Sutton</td>\n",
       "      <td>5.0</td>\n",
       "      <td>carlj102</td>\n",
       "      <td>Jim Carleton</td>\n",
       "      <td>3.0</td>\n",
       "      <td>bassj101</td>\n",
       "      <td>John Bass</td>\n",
       "      <td>6.0</td>\n",
       "      <td>mcatb101</td>\n",
       "      <td>Bub McAtee</td>\n",
       "      <td>3.0</td>\n",
       "      <td>kingm101</td>\n",
       "      <td>Marshall King</td>\n",
       "      <td>8.0</td>\n",
       "      <td>hodec101</td>\n",
       "      <td>Charlie Hodes</td>\n",
       "      <td>2.0</td>\n",
       "      <td>woodj106</td>\n",
       "      <td>Jimmy Wood</td>\n",
       "      <td>4.0</td>\n",
       "      <td>simmj101</td>\n",
       "      <td>Joe Simmons</td>\n",
       "      <td>9.0</td>\n",
       "      <td>folet101</td>\n",
       "      <td>Tom Foley</td>\n",
       "      <td>7.0</td>\n",
       "      <td>duffe101</td>\n",
       "      <td>Ed Duffy</td>\n",
       "      <td>6.0</td>\n",
       "      <td>pinke101</td>\n",
       "      <td>Ed Pinkham</td>\n",
       "      <td>5.0</td>\n",
       "      <td>zettg101</td>\n",
       "      <td>George Zettlein</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>18710509</td>\n",
       "      <td>0</td>\n",
       "      <td>Tue</td>\n",
       "      <td>BS1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>TRO</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>TRO01</td>\n",
       "      <td>3250.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>000002232</td>\n",
       "      <td>101003000</td>\n",
       "      <td>46.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>leroi901</td>\n",
       "      <td>Isaac Leroy</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>pikel101</td>\n",
       "      <td>Lip Pike</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>mcmuj101</td>\n",
       "      <td>John McMullin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>mcmuj101</td>\n",
       "      <td>John McMullin</td>\n",
       "      <td>wrigg101</td>\n",
       "      <td>George Wright</td>\n",
       "      <td>6.0</td>\n",
       "      <td>barnr102</td>\n",
       "      <td>Ross Barnes</td>\n",
       "      <td>4.0</td>\n",
       "      <td>birdd102</td>\n",
       "      <td>Dave Birdsall</td>\n",
       "      <td>9.0</td>\n",
       "      <td>mcvec101</td>\n",
       "      <td>Cal McVey</td>\n",
       "      <td>2.0</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>8.0</td>\n",
       "      <td>goulc101</td>\n",
       "      <td>Charlie Gould</td>\n",
       "      <td>3.0</td>\n",
       "      <td>schah101</td>\n",
       "      <td>Harry Schafer</td>\n",
       "      <td>5.0</td>\n",
       "      <td>conef101</td>\n",
       "      <td>Fred Cone</td>\n",
       "      <td>7.0</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>1.0</td>\n",
       "      <td>flync101</td>\n",
       "      <td>Clipper Flynn</td>\n",
       "      <td>9.0</td>\n",
       "      <td>mcgem101</td>\n",
       "      <td>Mike McGeary</td>\n",
       "      <td>2.0</td>\n",
       "      <td>yorkt101</td>\n",
       "      <td>Tom York</td>\n",
       "      <td>8.0</td>\n",
       "      <td>mcmuj101</td>\n",
       "      <td>John McMullin</td>\n",
       "      <td>1.0</td>\n",
       "      <td>kings101</td>\n",
       "      <td>Steve King</td>\n",
       "      <td>7.0</td>\n",
       "      <td>beave101</td>\n",
       "      <td>Edward Beavens</td>\n",
       "      <td>4.0</td>\n",
       "      <td>bells101</td>\n",
       "      <td>Steve Bellan</td>\n",
       "      <td>5.0</td>\n",
       "      <td>pikel101</td>\n",
       "      <td>Lip Pike</td>\n",
       "      <td>3.0</td>\n",
       "      <td>cravb101</td>\n",
       "      <td>Bill Craver</td>\n",
       "      <td>6.0</td>\n",
       "      <td>HTBF</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       date  number_of_game day_of_week v_name v_league  v_game_number h_name  \\\n",
       "0  18710504               0         Thu    CL1      NaN              1    FW1   \n",
       "1  18710505               0         Fri    BS1      NaN              1    WS3   \n",
       "2  18710506               0         Sat    CL1      NaN              2    RC1   \n",
       "3  18710508               0         Mon    CL1      NaN              3    CH1   \n",
       "4  18710509               0         Tue    BS1      NaN              2    TRO   \n",
       "\n",
       "  h_league  h_game_number  v_score  h_score  length_outs day_night completion  \\\n",
       "0      NaN              1        0        2         54.0         D        NaN   \n",
       "1      NaN              1       20       18         54.0         D        NaN   \n",
       "2      NaN              1       12        4         54.0         D        NaN   \n",
       "3      NaN              1       12       14         54.0         D        NaN   \n",
       "4      NaN              1        9        5         54.0         D        NaN   \n",
       "\n",
       "  forefeit protest park_id  attendance  length_minutes v_line_score  \\\n",
       "0      NaN     NaN   FOR01       200.0           120.0    000000000   \n",
       "1      NaN     NaN   WAS01      5000.0           145.0    107000435   \n",
       "2      NaN     NaN   RCK01      1000.0           140.0    610020003   \n",
       "3      NaN     NaN   CHI01      5000.0           150.0    101403111   \n",
       "4      NaN     NaN   TRO01      3250.0           145.0    000002232   \n",
       "\n",
       "  h_line_score  v_at_bats  v_hits  v_doubles  v_triples  v_homeruns  v_rbi  \\\n",
       "0    010010000       30.0     4.0        1.0        0.0         0.0    0.0   \n",
       "1    640113030       41.0    13.0        1.0        2.0         0.0   13.0   \n",
       "2    010020100       49.0    11.0        1.0        1.0         0.0    8.0   \n",
       "3    077000000       46.0    15.0        2.0        1.0         2.0   10.0   \n",
       "4    101003000       46.0    17.0        4.0        1.0         0.0    6.0   \n",
       "\n",
       "   v_sacrifice_hits  v_sacrifice_flies  v_hit_by_pitch  v_walks  \\\n",
       "0               0.0                0.0             0.0      1.0   \n",
       "1               0.0                0.0             0.0     18.0   \n",
       "2               0.0                0.0             0.0      0.0   \n",
       "3               0.0                0.0             0.0      0.0   \n",
       "4               0.0                0.0             0.0      2.0   \n",
       "\n",
       "   v_intentional_walks  v_strikeouts  v_stolen_bases  v_caught_stealing  \\\n",
       "0                  NaN           6.0             1.0                NaN   \n",
       "1                  NaN           5.0             3.0                NaN   \n",
       "2                  NaN           1.0             0.0                NaN   \n",
       "3                  NaN           1.0             0.0                NaN   \n",
       "4                  NaN           0.0             1.0                NaN   \n",
       "\n",
       "   v_grounded_into_double  v_first_catcher_interference  v_left_on_base  \\\n",
       "0                    -1.0                           NaN             4.0   \n",
       "1                    -1.0                           NaN            12.0   \n",
       "2                    -1.0                           NaN            10.0   \n",
       "3                    -1.0                           NaN             7.0   \n",
       "4                    -1.0                           NaN            12.0   \n",
       "\n",
       "   v_pitchers_used  v_individual_earned_runs  v_team_earned_runs  \\\n",
       "0              1.0                       1.0                 1.0   \n",
       "1              1.0                       6.0                 6.0   \n",
       "2              1.0                       0.0                 0.0   \n",
       "3              1.0                       6.0                 6.0   \n",
       "4              1.0                       2.0                 2.0   \n",
       "\n",
       "   v_wild_pitches  v_balks  v_putouts  v_assists  v_errors  v_passed_balls  \\\n",
       "0             0.0      0.0       27.0        9.0       0.0             3.0   \n",
       "1             1.0      0.0       27.0       13.0      10.0             1.0   \n",
       "2             2.0      0.0       27.0       12.0       8.0             5.0   \n",
       "3             0.0      0.0       27.0       15.0      11.0             6.0   \n",
       "4             0.0      0.0       27.0       12.0       5.0             0.0   \n",
       "\n",
       "   v_double_plays  v_triple_plays  h_at_bats  h_hits  h_doubles  h_triples  \\\n",
       "0             0.0             0.0       31.0     4.0        1.0        0.0   \n",
       "1             2.0             0.0       49.0    14.0        2.0        0.0   \n",
       "2             0.0             0.0       36.0     7.0        2.0        1.0   \n",
       "3             0.0             0.0       43.0    11.0        2.0        0.0   \n",
       "4             1.0             0.0       36.0     9.0        0.0        0.0   \n",
       "\n",
       "   h_homeruns  h_rbi  h_sacrifice_hits  h_sacrifice_flies  h_hit_by_pitch  \\\n",
       "0         0.0    2.0               0.0                0.0             0.0   \n",
       "1         0.0   11.0               0.0                0.0             0.0   \n",
       "2         0.0    2.0               0.0                0.0             0.0   \n",
       "3         0.0    8.0               0.0                0.0             0.0   \n",
       "4         0.0    2.0               0.0                0.0             0.0   \n",
       "\n",
       "   h_walks  h_intentional_walks  h_strikeouts  h_stolen_bases  \\\n",
       "0      1.0                  NaN           0.0             0.0   \n",
       "1     10.0                  NaN           2.0             1.0   \n",
       "2      0.0                  NaN           3.0             5.0   \n",
       "3      4.0                  NaN           2.0             1.0   \n",
       "4      3.0                  NaN           0.0             2.0   \n",
       "\n",
       "   h_caught_stealing  h_grounded_into_double  h_first_catcher_interference  \\\n",
       "0                NaN                    -1.0                           NaN   \n",
       "1                NaN                    -1.0                           NaN   \n",
       "2                NaN                    -1.0                           NaN   \n",
       "3                NaN                    -1.0                           NaN   \n",
       "4                NaN                    -1.0                           NaN   \n",
       "\n",
       "   h_left_on_base  h_pitchers_used  h_individual_earned_runs  \\\n",
       "0             3.0              1.0                       0.0   \n",
       "1            14.0              1.0                       7.0   \n",
       "2             5.0              1.0                       3.0   \n",
       "3             6.0              1.0                       4.0   \n",
       "4             7.0              1.0                       3.0   \n",
       "\n",
       "   h_team_earned_runs  h_wild_pitches  h_balks  h_putouts  h_assists  \\\n",
       "0                 0.0             0.0      0.0       27.0        3.0   \n",
       "1                 7.0             0.0      0.0       27.0       20.0   \n",
       "2                 3.0             1.0      0.0       27.0       12.0   \n",
       "3                 4.0             0.0      0.0       27.0       14.0   \n",
       "4                 3.0             1.0      0.0       27.0       11.0   \n",
       "\n",
       "   h_errors  h_passed_balls  h_double_plays  h_triple_plays hp_umpire_id  \\\n",
       "0       3.0             1.0             1.0             0.0     boakj901   \n",
       "1      10.0             2.0             3.0             0.0     dobsh901   \n",
       "2      13.0             3.0             0.0             0.0     mawnj901   \n",
       "3       7.0             2.0             0.0             0.0     willg901   \n",
       "4       7.0             3.0             0.0             0.0     leroi901   \n",
       "\n",
       "    hp_umpire_name 1b_umpire_id 1b_umpire_name 2b_umpire_id 2b_umpire_name  \\\n",
       "0       John Boake          NaN            NaN          NaN            NaN   \n",
       "1     Henry Dobson          NaN            NaN          NaN            NaN   \n",
       "2       J.H. Manny          NaN            NaN          NaN            NaN   \n",
       "3  Gardner Willard          NaN            NaN          NaN            NaN   \n",
       "4      Isaac Leroy          NaN            NaN          NaN            NaN   \n",
       "\n",
       "  3b_umpire_id 3b_umpire_name lf_umpire_id lf_umpire_name rf_umpire_id  \\\n",
       "0          NaN            NaN          NaN            NaN          NaN   \n",
       "1          NaN            NaN          NaN            NaN          NaN   \n",
       "2          NaN            NaN          NaN            NaN          NaN   \n",
       "3          NaN            NaN          NaN            NaN          NaN   \n",
       "4          NaN            NaN          NaN            NaN          NaN   \n",
       "\n",
       "  rf_umpire_name v_manager_id v_manager_name h_manager_id  h_manager_name  \\\n",
       "0            NaN     paboc101  Charlie Pabor     lennb101     Bill Lennon   \n",
       "1            NaN     wrigh101   Harry Wright     younn801      Nick Young   \n",
       "2            NaN     paboc101  Charlie Pabor     hasts101  Scott Hastings   \n",
       "3            NaN     paboc101  Charlie Pabor     woodj106      Jimmy Wood   \n",
       "4            NaN     wrigh101   Harry Wright     pikel101        Lip Pike   \n",
       "\n",
       "  winning_pitcher_id winning_pitcher_name losing_pitcher_id  \\\n",
       "0           mathb101        Bobby Mathews          prata101   \n",
       "1           spala101          Al Spalding          braia102   \n",
       "2           prata101             Al Pratt          fishc102   \n",
       "3           zettg101      George Zettlein          prata101   \n",
       "4           spala101          Al Spalding          mcmuj101   \n",
       "\n",
       "  losing_pitcher_name saving_pitcher_id saving_pitcher_name  \\\n",
       "0            Al Pratt               NaN                 NaN   \n",
       "1        Asa Brainard               NaN                 NaN   \n",
       "2     Cherokee Fisher               NaN                 NaN   \n",
       "3            Al Pratt               NaN                 NaN   \n",
       "4       John McMullin               NaN                 NaN   \n",
       "\n",
       "  winning_rbi_batter_id winning_rbi_batter_id_name v_starting_pitcher_id  \\\n",
       "0                   NaN                        NaN              prata101   \n",
       "1                   NaN                        NaN              spala101   \n",
       "2                   NaN                        NaN              prata101   \n",
       "3                   NaN                        NaN              prata101   \n",
       "4                   NaN                        NaN              spala101   \n",
       "\n",
       "  v_starting_pitcher_name h_starting_pitcher_id h_starting_pitcher_name  \\\n",
       "0                Al Pratt              mathb101           Bobby Mathews   \n",
       "1             Al Spalding              braia102            Asa Brainard   \n",
       "2                Al Pratt              fishc102         Cherokee Fisher   \n",
       "3                Al Pratt              zettg101         George Zettlein   \n",
       "4             Al Spalding              mcmuj101           John McMullin   \n",
       "\n",
       "  v_player_1_id v_player_1_name  v_player_1_def_pos v_player_2_id  \\\n",
       "0      whitd102    Deacon White                 2.0      kimbg101   \n",
       "1      wrigg101   George Wright                 6.0      barnr102   \n",
       "2      whitd102    Deacon White                 2.0      kimbg101   \n",
       "3      whitd102    Deacon White                 2.0      kimbg101   \n",
       "4      wrigg101   George Wright                 6.0      barnr102   \n",
       "\n",
       "  v_player_2_name  v_player_2_def_pos v_player_3_id v_player_3_name  \\\n",
       "0    Gene Kimball                 4.0      paboc101   Charlie Pabor   \n",
       "1     Ross Barnes                 4.0      birdd102   Dave Birdsall   \n",
       "2    Gene Kimball                 4.0      paboc101   Charlie Pabor   \n",
       "3    Gene Kimball                 4.0      paboc101   Charlie Pabor   \n",
       "4     Ross Barnes                 4.0      birdd102   Dave Birdsall   \n",
       "\n",
       "   v_player_3_def_pos v_player_4_id v_player_4_name  v_player_4_def_pos  \\\n",
       "0                 7.0      allia101     Art Allison                 8.0   \n",
       "1                 9.0      mcvec101       Cal McVey                 2.0   \n",
       "2                 7.0      allia101     Art Allison                 8.0   \n",
       "3                 7.0      allia101     Art Allison                 8.0   \n",
       "4                 9.0      mcvec101       Cal McVey                 2.0   \n",
       "\n",
       "  v_player_5_id v_player_5_name  v_player_5_def_pos v_player_6_id  \\\n",
       "0      white104     Elmer White                 9.0      prata101   \n",
       "1      wrigh101    Harry Wright                 8.0      goulc101   \n",
       "2      white104     Elmer White                 9.0      prata101   \n",
       "3      white104     Elmer White                 9.0      prata101   \n",
       "4      wrigh101    Harry Wright                 8.0      goulc101   \n",
       "\n",
       "  v_player_6_name  v_player_6_def_pos v_player_7_id v_player_7_name  \\\n",
       "0        Al Pratt                 1.0      sutte101     Ezra Sutton   \n",
       "1   Charlie Gould                 3.0      schah101   Harry Schafer   \n",
       "2        Al Pratt                 1.0      sutte101     Ezra Sutton   \n",
       "3        Al Pratt                 1.0      sutte101     Ezra Sutton   \n",
       "4   Charlie Gould                 3.0      schah101   Harry Schafer   \n",
       "\n",
       "   v_player_7_def_pos v_player_8_id v_player_8_name  v_player_8_def_pos  \\\n",
       "0                 5.0      carlj102    Jim Carleton                 3.0   \n",
       "1                 5.0      conef101       Fred Cone                 7.0   \n",
       "2                 5.0      carlj102    Jim Carleton                 3.0   \n",
       "3                 5.0      carlj102    Jim Carleton                 3.0   \n",
       "4                 5.0      conef101       Fred Cone                 7.0   \n",
       "\n",
       "  v_player_9_id v_player_9_name  v_player_9_def_pos h_player_1_id  \\\n",
       "0      bassj101       John Bass                 6.0      selmf101   \n",
       "1      spala101     Al Spalding                 1.0      watef102   \n",
       "2      bassj101       John Bass                 6.0      mackd101   \n",
       "3      bassj101       John Bass                 6.0      mcatb101   \n",
       "4      spala101     Al Spalding                 1.0      flync101   \n",
       "\n",
       "  h_player_1_name  h_player_1_def_pos h_player_2_id h_player_2_name  \\\n",
       "0   Frank Sellman                 5.0      mathb101   Bobby Mathews   \n",
       "1   Fred Waterman                 5.0      forcd101      Davy Force   \n",
       "2      Denny Mack                 3.0      addyb101        Bob Addy   \n",
       "3      Bub McAtee                 3.0      kingm101   Marshall King   \n",
       "4   Clipper Flynn                 9.0      mcgem101    Mike McGeary   \n",
       "\n",
       "   h_player_2_def_pos h_player_3_id  h_player_3_name  h_player_3_def_pos  \\\n",
       "0                 1.0      foraj101        Jim Foran                 3.0   \n",
       "1                 6.0      mille105    Everett Mills                 3.0   \n",
       "2                 4.0      fishc102  Cherokee Fisher                 1.0   \n",
       "3                 8.0      hodec101    Charlie Hodes                 2.0   \n",
       "4                 2.0      yorkt101         Tom York                 8.0   \n",
       "\n",
       "  h_player_4_id  h_player_4_name  h_player_4_def_pos h_player_5_id  \\\n",
       "0      goldw101  Wally Goldsmith                 6.0      lennb101   \n",
       "1      allid101     Doug Allison                 2.0      hallg101   \n",
       "2      hasts101   Scott Hastings                 8.0      ham-r101   \n",
       "3      woodj106       Jimmy Wood                 4.0      simmj101   \n",
       "4      mcmuj101    John McMullin                 1.0      kings101   \n",
       "\n",
       "  h_player_5_name  h_player_5_def_pos h_player_6_id h_player_6_name  \\\n",
       "0     Bill Lennon                 2.0      caret101       Tom Carey   \n",
       "1     George Hall                 7.0      leona101    Andy Leonard   \n",
       "2       Ralph Ham                 5.0      ansoc101       Cap Anson   \n",
       "3     Joe Simmons                 9.0      folet101       Tom Foley   \n",
       "4      Steve King                 7.0      beave101  Edward Beavens   \n",
       "\n",
       "   h_player_6_def_pos h_player_7_id h_player_7_name  h_player_7_def_pos  \\\n",
       "0                 4.0      mince101      Ed Mincher                 7.0   \n",
       "1                 4.0      braia102    Asa Brainard                 1.0   \n",
       "2                 2.0      sagep101      Pony Sager                 6.0   \n",
       "3                 7.0      duffe101        Ed Duffy                 6.0   \n",
       "4                 4.0      bells101    Steve Bellan                 5.0   \n",
       "\n",
       "  h_player_8_id  h_player_8_name  h_player_8_def_pos h_player_9_id  \\\n",
       "0      mcdej101  James McDermott                 8.0      kellb105   \n",
       "1      burrh101  Henry Burroughs                 9.0      berth101   \n",
       "2      birdg101      George Bird                 7.0      stirg101   \n",
       "3      pinke101       Ed Pinkham                 5.0      zettg101   \n",
       "4      pikel101         Lip Pike                 3.0      cravb101   \n",
       "\n",
       "   h_player_9_name  h_player_9_def_pos additional_info acquisition_info  \n",
       "0       Bill Kelly                 9.0             NaN                Y  \n",
       "1  Henry Berthrong                 8.0            HTBF                Y  \n",
       "2       Gat Stires                 9.0             NaN                Y  \n",
       "3  George Zettlein                 1.0             NaN                Y  \n",
       "4      Bill Craver                 6.0            HTBF                Y  "
      ]
     },
     "execution_count": 97,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "game_log.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "D      82724\n",
       "N      57426\n",
       "NaN    31757\n",
       "Name: day_night, dtype: int64"
      ]
     },
     "execution_count": 98,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "game_log['day_night'].value_counts(dropna=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 99,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Field(s)  Meaning\n",
      "    1     Date in the form \"yyyymmdd\"\n",
      "    2     Number of game:\n",
      "             \"0\" -- a single game\n",
      "             \"1\" -- the first game of a double (or triple) header\n",
      "                    including seperate admission doubleheaders\n",
      "             \"2\" -- the second game of a double (or triple) header\n",
      "                    including seperate admission doubleheaders\n",
      "             \"3\" -- the third game of a triple-header\n",
      "             \"A\" -- the first game of a double-header involving 3 teams\n",
      "             \"B\" -- the second game of a double-header involving 3 teams\n",
      "    3     Day of week  (\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\")\n",
      "  4-5     Visiting team and league\n",
      "    6     Visiting team game number\n",
      "          For this and the home team game number, ties are counted as\n",
      "          games and suspended games are counted from the starting\n",
      "          rather than the ending date.\n",
      "  7-8     Home team and league\n",
      "    9     Home team game number\n",
      "10-11     Visiting and home team score (unquoted)\n",
      "   12     Length of game in outs (unquoted).  A full 9-inning game would\n",
      "          have a 54 in this field.  If the home team won without batting\n",
      "          in the bottom of the ninth, this field would contain a 51.\n",
      "   13     Day/night indicator (\"D\" or \"N\")\n",
      "   14     Completion information.  If the game was completed at a\n",
      "          later date (either due to a suspension or an upheld protest)\n",
      "          this field will include:\n",
      "             \"yyyymmdd,park,vs,hs,len\" Where\n",
      "          yyyymmdd -- the date the game was completed\n",
      "          park -- the park ID where the game was completed\n",
      "          vs -- the visitor score at the time of interruption\n",
      "          hs -- the home score at the time of interruption\n",
      "          len -- the length of the game in outs at time of interruption\n",
      "          All the rest of the information in the record refers to the\n",
      "          entire game.\n",
      "   15     Forfeit information:\n",
      "             \"V\" -- the game was forfeited to the visiting team\n",
      "             \"H\" -- the game was forfeited to the home team\n",
      "             \"T\" -- the game was ruled a no-decision\n",
      "   16     Protest information:\n",
      "             \"P\" -- the game was protested by an unidentified team\n",
      "             \"V\" -- a disallowed protest was made by the visiting team\n",
      "             \"H\" -- a disallowed protest was made by the home team\n",
      "             \"X\" -- an upheld protest was made by the visiting team\n",
      "             \"Y\" -- an upheld protest was made by the home team\n",
      "          Note: two of these last four codes can appear in the field\n",
      "          (if both teams protested the game).\n",
      "   17     Park ID\n",
      "   18     Attendance (unquoted)\n",
      "   19     Time of game in minutes (unquoted)\n",
      "20-21     Visiting and home line scores.  For example:\n",
      "             \"010000(10)0x\"\n",
      "          Would indicate a game where the home team scored a run in\n",
      "          the second inning, ten in the seventh and didn't bat in the\n",
      "          bottom of the ninth.\n",
      "22-38     Visiting team offensive statistics (unquoted) (in order):\n",
      "             at-bats\n",
      "             hits\n",
      "             doubles\n",
      "             triples\n",
      "             homeruns\n",
      "             RBI\n",
      "             sacrifice hits.  This may include sacrifice flies for years\n",
      "                prior to 1954 when sacrifice flies were allowed.\n",
      "             sacrifice flies (since 1954)\n",
      "             hit-by-pitch\n",
      "             walks\n",
      "             intentional walks\n",
      "             strikeouts\n",
      "             stolen bases\n",
      "             caught stealing\n",
      "             grounded into double plays\n",
      "             awarded first on catcher's interference\n",
      "             left on base\n",
      "39-43     Visiting team pitching statistics (unquoted)(in order):\n",
      "             pitchers used ( 1 means it was a complete game )\n",
      "             individual earned runs\n",
      "             team earned runs\n",
      "             wild pitches\n",
      "             balks\n",
      "44-49     Visiting team defensive statistics (unquoted) (in order):\n",
      "             putouts.  Note: prior to 1931, this may not equal 3 times\n",
      "                the number of innings pitched.  Prior to that, no\n",
      "                putout was awarded when a runner was declared out for\n",
      "                being hit by a batted ball.\n",
      "             assists\n",
      "             errors\n",
      "             passed balls\n",
      "             double plays\n",
      "             triple plays\n",
      "50-66     Home team offensive statistics\n",
      "67-71     Home team pitching statistics\n",
      "72-77     Home team defensive statistics\n",
      "78-79     Home plate umpire ID and name\n",
      "80-81     1B umpire ID and name\n",
      "82-83     2B umpire ID and name\n",
      "84-85     3B umpire ID and name\n",
      "86-87     LF umpire ID and name\n",
      "88-89     RF umpire ID and name\n",
      "          If any umpire positions were not filled for a particular game\n",
      "          the fields will be \"\",\"(none)\".\n",
      "90-91     Visiting team manager ID and name\n",
      "92-93     Home team manager ID and name\n",
      "94-95     Winning pitcher ID and name\n",
      "96-97     Losing pitcher ID and name\n",
      "98-99     Saving pitcher ID and name--\"\",\"(none)\" if none awarded\n",
      "100-101   Game Winning RBI batter ID and name--\"\",\"(none)\" if none\n",
      "          awarded\n",
      "102-103   Visiting starting pitcher ID and name\n",
      "104-105   Home starting pitcher ID and name\n",
      "106-132   Visiting starting players ID, name and defensive position,\n",
      "          listed in the order (1-9) they appeared in the batting order.\n",
      "133-159   Home starting players ID, name and defensive position\n",
      "          listed in the order (1-9) they appeared in the batting order.\n",
      "  160     Additional information.  This is a grab-bag of informational\n",
      "          items that might not warrant a field on their own.  The field \n",
      "          is alpha-numeric. Some items are represented by tokens such as:\n",
      "             \"HTBF\" -- home team batted first.\n",
      "             Note: if \"HTBF\" is specified it would be possible to see\n",
      "             something like \"01002000x\" in the visitor's line score.\n",
      "          Changes in umpire positions during a game will also appear in \n",
      "          this field.  These will be in the form:\n",
      "             umpchange,inning,umpPosition,umpid with the latter three\n",
      "             repeated for each umpire.\n",
      "          These changes occur with umpire injuries, late arrival of \n",
      "          umpires or changes from completion of suspended games. Details\n",
      "          of suspended games are in field 14.\n",
      "  161     Acquisition information:\n",
      "             \"Y\" -- we have the complete game\n",
      "             \"N\" -- we don't have any portion of the game\n",
      "             \"D\" -- the game was derived from box score and game story\n",
      "             \"P\" -- we have some portion of the game.  We may be missing\n",
      "                    innings at the beginning, middle and end of the game.\n",
      " \n",
      "Missing fields will be NULL.\n",
      "\u001a"
     ]
    }
   ],
   "source": [
    "!cat game_log_fields.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 100,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>park_id</th>\n",
       "      <th>name</th>\n",
       "      <th>aka</th>\n",
       "      <th>city</th>\n",
       "      <th>state</th>\n",
       "      <th>start</th>\n",
       "      <th>end</th>\n",
       "      <th>league</th>\n",
       "      <th>notes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ALB01</td>\n",
       "      <td>Riverside Park</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Albany</td>\n",
       "      <td>NY</td>\n",
       "      <td>09/11/1880</td>\n",
       "      <td>05/30/1882</td>\n",
       "      <td>NL</td>\n",
       "      <td>TRN:9/11/80;6/15&amp;9/10/1881;5/16-5/18&amp;5/30/1882</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ALT01</td>\n",
       "      <td>Columbia Park</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Altoona</td>\n",
       "      <td>PA</td>\n",
       "      <td>04/30/1884</td>\n",
       "      <td>05/31/1884</td>\n",
       "      <td>UA</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ANA01</td>\n",
       "      <td>Angel Stadium of Anaheim</td>\n",
       "      <td>Edison Field; Anaheim Stadium</td>\n",
       "      <td>Anaheim</td>\n",
       "      <td>CA</td>\n",
       "      <td>04/19/1966</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ARL01</td>\n",
       "      <td>Arlington Stadium</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Arlington</td>\n",
       "      <td>TX</td>\n",
       "      <td>04/21/1972</td>\n",
       "      <td>10/03/1993</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ARL02</td>\n",
       "      <td>Rangers Ballpark in Arlington</td>\n",
       "      <td>The Ballpark in Arlington; Ameriquest Fl</td>\n",
       "      <td>Arlington</td>\n",
       "      <td>TX</td>\n",
       "      <td>04/11/1994</td>\n",
       "      <td>NaN</td>\n",
       "      <td>AL</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  park_id                           name  \\\n",
       "0   ALB01                 Riverside Park   \n",
       "1   ALT01                  Columbia Park   \n",
       "2   ANA01       Angel Stadium of Anaheim   \n",
       "3   ARL01              Arlington Stadium   \n",
       "4   ARL02  Rangers Ballpark in Arlington   \n",
       "\n",
       "                                        aka       city state       start  \\\n",
       "0                                       NaN     Albany    NY  09/11/1880   \n",
       "1                                       NaN    Altoona    PA  04/30/1884   \n",
       "2             Edison Field; Anaheim Stadium    Anaheim    CA  04/19/1966   \n",
       "3                                       NaN  Arlington    TX  04/21/1972   \n",
       "4  The Ballpark in Arlington; Ameriquest Fl  Arlington    TX  04/11/1994   \n",
       "\n",
       "          end league                                           notes  \n",
       "0  05/30/1882     NL  TRN:9/11/80;6/15&9/10/1881;5/16-5/18&5/30/1882  \n",
       "1  05/31/1884     UA                                             NaN  \n",
       "2         NaN     AL                                             NaN  \n",
       "3  10/03/1993     AL                                             NaN  \n",
       "4         NaN     AL                                             NaN  "
      ]
     },
     "execution_count": 100,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "park_codes.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 101,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>last</th>\n",
       "      <th>first</th>\n",
       "      <th>player_debut</th>\n",
       "      <th>mgr_debut</th>\n",
       "      <th>coach_debut</th>\n",
       "      <th>ump_debut</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>aardd001</td>\n",
       "      <td>Aardsma</td>\n",
       "      <td>David</td>\n",
       "      <td>04/06/2004</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>aaroh101</td>\n",
       "      <td>Aaron</td>\n",
       "      <td>Hank</td>\n",
       "      <td>04/13/1954</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>aarot101</td>\n",
       "      <td>Aaron</td>\n",
       "      <td>Tommie</td>\n",
       "      <td>04/10/1962</td>\n",
       "      <td>NaN</td>\n",
       "      <td>04/06/1979</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>aased001</td>\n",
       "      <td>Aase</td>\n",
       "      <td>Don</td>\n",
       "      <td>07/26/1977</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>abada001</td>\n",
       "      <td>Abad</td>\n",
       "      <td>Andy</td>\n",
       "      <td>09/10/2001</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         id     last   first player_debut mgr_debut coach_debut ump_debut\n",
       "0  aardd001  Aardsma   David   04/06/2004       NaN         NaN       NaN\n",
       "1  aaroh101    Aaron    Hank   04/13/1954       NaN         NaN       NaN\n",
       "2  aarot101    Aaron  Tommie   04/10/1962       NaN  04/06/1979       NaN\n",
       "3  aased001     Aase     Don   07/26/1977       NaN         NaN       NaN\n",
       "4  abada001     Abad    Andy   09/10/2001       NaN         NaN       NaN"
      ]
     },
     "execution_count": 101,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "person_codes.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>team_id</th>\n",
       "      <th>league</th>\n",
       "      <th>start</th>\n",
       "      <th>end</th>\n",
       "      <th>city</th>\n",
       "      <th>nickname</th>\n",
       "      <th>franch_id</th>\n",
       "      <th>seq</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ALT</td>\n",
       "      <td>UA</td>\n",
       "      <td>1884</td>\n",
       "      <td>1884</td>\n",
       "      <td>Altoona</td>\n",
       "      <td>Mountain Cities</td>\n",
       "      <td>ALT</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ARI</td>\n",
       "      <td>NL</td>\n",
       "      <td>1998</td>\n",
       "      <td>0</td>\n",
       "      <td>Arizona</td>\n",
       "      <td>Diamondbacks</td>\n",
       "      <td>ARI</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>BFN</td>\n",
       "      <td>NL</td>\n",
       "      <td>1879</td>\n",
       "      <td>1885</td>\n",
       "      <td>Buffalo</td>\n",
       "      <td>Bisons</td>\n",
       "      <td>BFN</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BFP</td>\n",
       "      <td>PL</td>\n",
       "      <td>1890</td>\n",
       "      <td>1890</td>\n",
       "      <td>Buffalo</td>\n",
       "      <td>Bisons</td>\n",
       "      <td>BFP</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>BL1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1872</td>\n",
       "      <td>1874</td>\n",
       "      <td>Baltimore</td>\n",
       "      <td>Canaries</td>\n",
       "      <td>BL1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  team_id league  start   end       city         nickname franch_id  seq\n",
       "0     ALT     UA   1884  1884    Altoona  Mountain Cities       ALT    1\n",
       "1     ARI     NL   1998     0    Arizona     Diamondbacks       ARI    1\n",
       "2     BFN     NL   1879  1885    Buffalo           Bisons       BFN    1\n",
       "3     BFP     PL   1890  1890    Buffalo           Bisons       BFP    1\n",
       "4     BL1    NaN   1872  1874  Baltimore         Canaries       BL1    1"
      ]
     },
     "execution_count": 102,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "team_codes.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The game_log file contains 161 descriptive columns for over 170,000 baseball games, including data such as names of umpires, names of winning pitchers, the defensive positions of each player in each game, among others."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "-  The park_codes file contains information about ballparks where games were played, connected to the game_log through the 'park_id' column\n",
    "-  The person_codes file contains information about all people (players, managers, umpires) found in the game_log file. The 'id' column of person_codes matches id's found in the game_log file wherever an id is used to indicate a person\n",
    "-  The team_codes table contains information regarding all teams which have recorded games in the game_log table. Each team has a unique ID recorded in the 'team_id' column. This column corresponds to any column in the game_log table with team_id information."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Defensive Positions\n",
    "-  1: Pitcher\n",
    "-  2: Catcher\n",
    "-  3: First Baseman\n",
    "-  4: Second Baseman\n",
    "-  5: Third Baseman\n",
    "-  6: Shortstop\n",
    "-  7: Left Field\n",
    "-  8: Center Field\n",
    "-  9: Right Field"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['UA', 'NL', 'PL', nan, 'AA', 'AL', 'FL'], dtype=object)"
      ]
     },
     "execution_count": 103,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "team_codes['league'].unique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Leagues\n",
    "-  UA: Union Association, 1884\n",
    "-  NL: National League, one of two current leagues\n",
    "-  PL: Players' League, 19th century league, ended 1890\n",
    "-  AA: American Association, 1882-1891\n",
    "-  AL: American League, the other current league\n",
    "-  FL: Federal League, 1913-1915"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "# Create helper functions\n",
    "DB = 'mlb.db'\n",
    "\n",
    "def run_query(q):\n",
    "    with sqlite3.connect(DB) as conn:\n",
    "        return pd.read_sql(q, conn)\n",
    "    \n",
    "def run_command(c):\n",
    "    with sqlite3.connect(DB) as conn:\n",
    "        conn.execute('PRAGMA foreign_keys = ON')\n",
    "        conn.isolation_level = None\n",
    "        conn.execute(c)\n",
    "        \n",
    "def show_tables():\n",
    "    q = '''\n",
    "    SELECT\n",
    "        name\n",
    "        type\n",
    "    FROM sqlite_master\n",
    "    WHERE type IN (\"table\", \"view\");\n",
    "    '''\n",
    "    return run_query(q)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "with sqlite3.connect(DB) as conn:\n",
    "    game_log.to_sql('game_log', conn, index=False, if_exists='replace')\n",
    "    park_codes.to_sql('park_codes', conn, index=False, if_exists='replace')\n",
    "    person_codes.to_sql('person_codes', conn, index=False, if_exists='replace')\n",
    "    team_codes.to_sql('team_codes', conn, index=False, if_exists='replace')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>park</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>league</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>team_apperance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>person</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>appearance_type</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>appearance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>team</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>game</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>team_appearance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>person_appearance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>game_log</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>park_codes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>person_codes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>team_codes</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 type\n",
       "0                park\n",
       "1              league\n",
       "2      team_apperance\n",
       "3              person\n",
       "4     appearance_type\n",
       "5          appearance\n",
       "6                team\n",
       "7                game\n",
       "8     team_appearance\n",
       "9   person_appearance\n",
       "10           game_log\n",
       "11         park_codes\n",
       "12       person_codes\n",
       "13         team_codes"
      ]
     },
     "execution_count": 106,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "show_tables()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c1 = '''\n",
    "ALTER TABLE game_log\n",
    "ADD COLUMN game_id;\n",
    "'''\n",
    "run_command(c1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "c2 = '''\n",
    "UPDATE game_log\n",
    "SET game_id = h_name || date || number_of_game;\n",
    "'''\n",
    "run_command(c2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>game_id</th>\n",
       "      <th>h_name</th>\n",
       "      <th>date</th>\n",
       "      <th>number_of_game</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>FW1187105040</td>\n",
       "      <td>FW1</td>\n",
       "      <td>18710504</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>WS3187105050</td>\n",
       "      <td>WS3</td>\n",
       "      <td>18710505</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>RC1187105060</td>\n",
       "      <td>RC1</td>\n",
       "      <td>18710506</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CH1187105080</td>\n",
       "      <td>CH1</td>\n",
       "      <td>18710508</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>TRO187105090</td>\n",
       "      <td>TRO</td>\n",
       "      <td>18710509</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        game_id h_name      date  number_of_game\n",
       "0  FW1187105040    FW1  18710504               0\n",
       "1  WS3187105050    WS3  18710505               0\n",
       "2  RC1187105060    RC1  18710506               0\n",
       "3  CH1187105080    CH1  18710508               0\n",
       "4  TRO187105090    TRO  18710509               0"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "q1 = '''SELECT game_id, h_name, date, number_of_game FROM game_log LIMIT 5'''\n",
    "run_query(q1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Opportunities for Normalization\n",
    "-  park_codes: start, end, and league can all be found elsewhere\n",
    "-  person_codes: debut columns can be derived from game_log\n",
    "-  team_codes: start and end can be derived from game_log"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c2 = '''\n",
    "CREATE TABLE IF NOT EXISTS person (\n",
    "    person_id TEXT PRIMARY KEY,\n",
    "    first_name TEXT,\n",
    "    last_name TEXT\n",
    ");\n",
    "'''\n",
    "run_command(c2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>person_id</th>\n",
       "      <th>first_name</th>\n",
       "      <th>last_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>aardd001</td>\n",
       "      <td>David</td>\n",
       "      <td>Aardsma</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>aaroh101</td>\n",
       "      <td>Hank</td>\n",
       "      <td>Aaron</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>aarot101</td>\n",
       "      <td>Tommie</td>\n",
       "      <td>Aaron</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>aased001</td>\n",
       "      <td>Don</td>\n",
       "      <td>Aase</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>abada001</td>\n",
       "      <td>Andy</td>\n",
       "      <td>Abad</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>abadf001</td>\n",
       "      <td>Fernando</td>\n",
       "      <td>Abad</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>abadj101</td>\n",
       "      <td>John</td>\n",
       "      <td>Abadie</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>abbae101</td>\n",
       "      <td>Ed</td>\n",
       "      <td>Abbaticchio</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>abbeb101</td>\n",
       "      <td>Bert</td>\n",
       "      <td>Abbey</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>abbec101</td>\n",
       "      <td>Charlie</td>\n",
       "      <td>Abbey</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  person_id first_name    last_name\n",
       "0  aardd001      David      Aardsma\n",
       "1  aaroh101       Hank        Aaron\n",
       "2  aarot101     Tommie        Aaron\n",
       "3  aased001        Don         Aase\n",
       "4  abada001       Andy         Abad\n",
       "5  abadf001   Fernando         Abad\n",
       "6  abadj101       John       Abadie\n",
       "7  abbae101         Ed  Abbaticchio\n",
       "8  abbeb101       Bert        Abbey\n",
       "9  abbec101    Charlie        Abbey"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM person LIMIT 10'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "c3 = '''\n",
    "INSERT OR IGNORE INTO person\n",
    "SELECT id, first, last FROM person_codes;'''\n",
    "run_command(c3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>person_id</th>\n",
       "      <th>first_name</th>\n",
       "      <th>last_name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>aardd001</td>\n",
       "      <td>David</td>\n",
       "      <td>Aardsma</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>aaroh101</td>\n",
       "      <td>Hank</td>\n",
       "      <td>Aaron</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>aarot101</td>\n",
       "      <td>Tommie</td>\n",
       "      <td>Aaron</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>aased001</td>\n",
       "      <td>Don</td>\n",
       "      <td>Aase</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>abada001</td>\n",
       "      <td>Andy</td>\n",
       "      <td>Abad</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  person_id first_name last_name\n",
       "0  aardd001      David   Aardsma\n",
       "1  aaroh101       Hank     Aaron\n",
       "2  aarot101     Tommie     Aaron\n",
       "3  aased001        Don      Aase\n",
       "4  abada001       Andy      Abad"
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM person LIMIT 5'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c4 = '''\n",
    "CREATE TABLE IF NOT EXISTS park\n",
    "(\n",
    "park_id TEXT PRIMARY KEY,\n",
    "name TEXT,\n",
    "nickname TEXT,\n",
    "city TEXT,\n",
    "state TEXT,\n",
    "notes TEXT\n",
    ");\n",
    "'''\n",
    "run_command(c4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "c5 = '''\n",
    "INSERT OR IGNORE INTO park\n",
    "SELECT\n",
    "    park_id,\n",
    "    name,\n",
    "    aka,\n",
    "    city,\n",
    "    state,\n",
    "    notes\n",
    "FROM park_codes'''\n",
    "\n",
    "run_command(c5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>park_id</th>\n",
       "      <th>name</th>\n",
       "      <th>nickname</th>\n",
       "      <th>city</th>\n",
       "      <th>state</th>\n",
       "      <th>notes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ALB01</td>\n",
       "      <td>Riverside Park</td>\n",
       "      <td>None</td>\n",
       "      <td>Albany</td>\n",
       "      <td>NY</td>\n",
       "      <td>TRN:9/11/80;6/15&amp;9/10/1881;5/16-5/18&amp;5/30/1882</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ALT01</td>\n",
       "      <td>Columbia Park</td>\n",
       "      <td>None</td>\n",
       "      <td>Altoona</td>\n",
       "      <td>PA</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ANA01</td>\n",
       "      <td>Angel Stadium of Anaheim</td>\n",
       "      <td>Edison Field; Anaheim Stadium</td>\n",
       "      <td>Anaheim</td>\n",
       "      <td>CA</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ARL01</td>\n",
       "      <td>Arlington Stadium</td>\n",
       "      <td>None</td>\n",
       "      <td>Arlington</td>\n",
       "      <td>TX</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ARL02</td>\n",
       "      <td>Rangers Ballpark in Arlington</td>\n",
       "      <td>The Ballpark in Arlington; Ameriquest Fl</td>\n",
       "      <td>Arlington</td>\n",
       "      <td>TX</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  park_id                           name  \\\n",
       "0   ALB01                 Riverside Park   \n",
       "1   ALT01                  Columbia Park   \n",
       "2   ANA01       Angel Stadium of Anaheim   \n",
       "3   ARL01              Arlington Stadium   \n",
       "4   ARL02  Rangers Ballpark in Arlington   \n",
       "\n",
       "                                   nickname       city state  \\\n",
       "0                                      None     Albany    NY   \n",
       "1                                      None    Altoona    PA   \n",
       "2             Edison Field; Anaheim Stadium    Anaheim    CA   \n",
       "3                                      None  Arlington    TX   \n",
       "4  The Ballpark in Arlington; Ameriquest Fl  Arlington    TX   \n",
       "\n",
       "                                            notes  \n",
       "0  TRN:9/11/80;6/15&9/10/1881;5/16-5/18&5/30/1882  \n",
       "1                                            None  \n",
       "2                                            None  \n",
       "3                                            None  \n",
       "4                                            None  "
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM park LIMIT 5'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c6 = '''\n",
    "CREATE TABLE IF NOT EXISTS league\n",
    "(\n",
    "league_id TEXT PRIMARY KEY,\n",
    "name TEXT\n",
    ");\n",
    "'''\n",
    "run_command(c6)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c7 = '''\n",
    "INSERT OR IGNORE INTO league\n",
    "VALUES\n",
    "    ('NL', 'National League'),\n",
    "    ('AL', 'American League'),\n",
    "    ('UA', 'Union Association'),\n",
    "    ('PL', \"Players' League\"),\n",
    "    ('AA', 'American Association'),\n",
    "    ('FL', 'Federal League')\n",
    ";'''\n",
    "run_command(c7)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>league_id</th>\n",
       "      <th>name</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NL</td>\n",
       "      <td>National League</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AL</td>\n",
       "      <td>American League</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>FL</td>\n",
       "      <td>Federal League</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>UA</td>\n",
       "      <td>Union Association</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>PL</td>\n",
       "      <td>Players' League</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>AA</td>\n",
       "      <td>American Association</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  league_id                  name\n",
       "0        NL       National League\n",
       "1        AL       American League\n",
       "2        FL        Federal League\n",
       "3        UA     Union Association\n",
       "4        PL       Players' League\n",
       "5        AA  American Association"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM league'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 120,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "cc = \"DROP TABLE IF EXISTS appearance_type\"\n",
    "run_command(cc)\n",
    "\n",
    "c8 = '''\n",
    "CREATE TABLE appearance_type\n",
    "(\n",
    "appearance_type_id TEXT PRIMARY KEY,\n",
    "name TEXT,\n",
    "category TEXT\n",
    ");'''\n",
    "run_command(c8)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appearance_type_id</th>\n",
       "      <th>name</th>\n",
       "      <th>category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>O1</td>\n",
       "      <td>Batter 1</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>O2</td>\n",
       "      <td>Batter 2</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>O3</td>\n",
       "      <td>Batter 3</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>O4</td>\n",
       "      <td>Batter 4</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>O5</td>\n",
       "      <td>Batter 5</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  appearance_type_id      name category\n",
       "0                 O1  Batter 1  offense\n",
       "1                 O2  Batter 2  offense\n",
       "2                 O3  Batter 3  offense\n",
       "3                 O4  Batter 4  offense\n",
       "4                 O5  Batter 5  offense"
      ]
     },
     "execution_count": 121,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "appearance_type = pd.read_csv('appearance_type.csv')\n",
    "appearance_type.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "BD = 'mlb.db'\n",
    "with sqlite3.connect(BD) as conn:\n",
    "    appearance_type.to_sql('appearance', conn, index=False, if_exists='replace')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c9 = '''\n",
    "INSERT OR IGNORE INTO appearance_type\n",
    "SELECT \n",
    "    appearance_type_id,\n",
    "    name,\n",
    "    category\n",
    "FROM appearance\n",
    ";'''\n",
    "run_command(c9)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>appearance_type_id</th>\n",
       "      <th>name</th>\n",
       "      <th>category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>O1</td>\n",
       "      <td>Batter 1</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>O2</td>\n",
       "      <td>Batter 2</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>O3</td>\n",
       "      <td>Batter 3</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>O4</td>\n",
       "      <td>Batter 4</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>O5</td>\n",
       "      <td>Batter 5</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>O6</td>\n",
       "      <td>Batter 6</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>O7</td>\n",
       "      <td>Batter 7</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>O8</td>\n",
       "      <td>Batter 8</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>O9</td>\n",
       "      <td>Batter 9</td>\n",
       "      <td>offense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>D1</td>\n",
       "      <td>Pitcher</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>D2</td>\n",
       "      <td>Catcher</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>D3</td>\n",
       "      <td>1st Base</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>D4</td>\n",
       "      <td>2nd Base</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>D5</td>\n",
       "      <td>3rd Base</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>D6</td>\n",
       "      <td>Shortstop</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>D7</td>\n",
       "      <td>Left Field</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>D8</td>\n",
       "      <td>Center Field</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>D9</td>\n",
       "      <td>Right Field</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>D10</td>\n",
       "      <td>Unknown Position</td>\n",
       "      <td>defense</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>UHP</td>\n",
       "      <td>Home Plate</td>\n",
       "      <td>umpire</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>U1B</td>\n",
       "      <td>First Base</td>\n",
       "      <td>umpire</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>U2B</td>\n",
       "      <td>Second Base</td>\n",
       "      <td>umpire</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>U3B</td>\n",
       "      <td>Third Base</td>\n",
       "      <td>umpire</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>ULF</td>\n",
       "      <td>Left Field</td>\n",
       "      <td>umpire</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>URF</td>\n",
       "      <td>Right Field</td>\n",
       "      <td>umpire</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>MM</td>\n",
       "      <td>Manager</td>\n",
       "      <td>manager</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>AWP</td>\n",
       "      <td>Winning Pitcher</td>\n",
       "      <td>award</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>ALP</td>\n",
       "      <td>Losing Pitcher</td>\n",
       "      <td>award</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>ASP</td>\n",
       "      <td>Saving Pitcher</td>\n",
       "      <td>award</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>AWB</td>\n",
       "      <td>Winning RBI Batter</td>\n",
       "      <td>award</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>PSP</td>\n",
       "      <td>Starting Pitcher</td>\n",
       "      <td>pitcher</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   appearance_type_id                name category\n",
       "0                  O1            Batter 1  offense\n",
       "1                  O2            Batter 2  offense\n",
       "2                  O3            Batter 3  offense\n",
       "3                  O4            Batter 4  offense\n",
       "4                  O5            Batter 5  offense\n",
       "5                  O6            Batter 6  offense\n",
       "6                  O7            Batter 7  offense\n",
       "7                  O8            Batter 8  offense\n",
       "8                  O9            Batter 9  offense\n",
       "9                  D1             Pitcher  defense\n",
       "10                 D2             Catcher  defense\n",
       "11                 D3            1st Base  defense\n",
       "12                 D4            2nd Base  defense\n",
       "13                 D5            3rd Base  defense\n",
       "14                 D6           Shortstop  defense\n",
       "15                 D7          Left Field  defense\n",
       "16                 D8        Center Field  defense\n",
       "17                 D9         Right Field  defense\n",
       "18                D10    Unknown Position  defense\n",
       "19                UHP          Home Plate   umpire\n",
       "20                U1B          First Base   umpire\n",
       "21                U2B         Second Base   umpire\n",
       "22                U3B          Third Base   umpire\n",
       "23                ULF          Left Field   umpire\n",
       "24                URF         Right Field   umpire\n",
       "25                 MM             Manager  manager\n",
       "26                AWP     Winning Pitcher    award\n",
       "27                ALP      Losing Pitcher    award\n",
       "28                ASP      Saving Pitcher    award\n",
       "29                AWB  Winning RBI Batter    award\n",
       "30                PSP    Starting Pitcher  pitcher"
      ]
     },
     "execution_count": 124,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM appearance_type'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "c10 = '''\n",
    "CREATE TABLE IF NOT EXISTS team\n",
    "(\n",
    "team_id TEXT PRIMARY KEY,\n",
    "league_id TEXT,\n",
    "city TEXT,\n",
    "nickname TEXT,\n",
    "franch_id TEXT,\n",
    "FOREIGN KEY (league_id) REFERENCES league(league_id)\n",
    ");'''\n",
    "run_command(c10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c11 = '''\n",
    "INSERT OR IGNORE INTO team\n",
    "SELECT\n",
    "    team_id,\n",
    "    league,\n",
    "    city,\n",
    "    nickname,\n",
    "    franch_id\n",
    "FROM team_codes\n",
    ";'''\n",
    "run_command(c11)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>team_id</th>\n",
       "      <th>league_id</th>\n",
       "      <th>city</th>\n",
       "      <th>nickname</th>\n",
       "      <th>franch_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ALT</td>\n",
       "      <td>UA</td>\n",
       "      <td>Altoona</td>\n",
       "      <td>Mountain Cities</td>\n",
       "      <td>ALT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ARI</td>\n",
       "      <td>NL</td>\n",
       "      <td>Arizona</td>\n",
       "      <td>Diamondbacks</td>\n",
       "      <td>ARI</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>BFN</td>\n",
       "      <td>NL</td>\n",
       "      <td>Buffalo</td>\n",
       "      <td>Bisons</td>\n",
       "      <td>BFN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>BFP</td>\n",
       "      <td>PL</td>\n",
       "      <td>Buffalo</td>\n",
       "      <td>Bisons</td>\n",
       "      <td>BFP</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>BL1</td>\n",
       "      <td>None</td>\n",
       "      <td>Baltimore</td>\n",
       "      <td>Canaries</td>\n",
       "      <td>BL1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  team_id league_id       city         nickname franch_id\n",
       "0     ALT        UA    Altoona  Mountain Cities       ALT\n",
       "1     ARI        NL    Arizona     Diamondbacks       ARI\n",
       "2     BFN        NL    Buffalo           Bisons       BFN\n",
       "3     BFP        PL    Buffalo           Bisons       BFP\n",
       "4     BL1      None  Baltimore         Canaries       BL1"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM team LIMIT 5'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "c12 = '''\n",
    "CREATE TABLE IF NOT EXISTS game\n",
    "(\n",
    "game_id TEXT PRIMARY KEY,\n",
    "date INTEGER,\n",
    "number_of_game INTEGER,\n",
    "park_id TEXT,\n",
    "length_outs REAL,\n",
    "day INTEGER,\n",
    "completion TEXT,\n",
    "forefeit TEXT,\n",
    "protest TEXT,\n",
    "attendance REAL,\n",
    "length_minutes REAL,\n",
    "additional_info TEXT,\n",
    "acquisition_info TEXT,\n",
    "FOREIGN KEY (park_id) REFERENCES park(park_id)\n",
    ");\n",
    "'''\n",
    "run_command(c12)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c13 = '''\n",
    "INSERT OR IGNORE INTO game\n",
    "SELECT\n",
    "    game_id,\n",
    "    date,\n",
    "    number_of_game,\n",
    "    park_id,\n",
    "    length_outs,\n",
    "    day_night,\n",
    "    completion,\n",
    "    forefeit,\n",
    "    protest,\n",
    "    attendance,\n",
    "    length_minutes,\n",
    "    additional_info,\n",
    "    acquisition_info\n",
    "FROM game_log\n",
    ";'''\n",
    "run_command(c13)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>game_id</th>\n",
       "      <th>date</th>\n",
       "      <th>number_of_game</th>\n",
       "      <th>park_id</th>\n",
       "      <th>length_outs</th>\n",
       "      <th>day</th>\n",
       "      <th>completion</th>\n",
       "      <th>forefeit</th>\n",
       "      <th>protest</th>\n",
       "      <th>attendance</th>\n",
       "      <th>length_minutes</th>\n",
       "      <th>additional_info</th>\n",
       "      <th>acquisition_info</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>FW1187105040</td>\n",
       "      <td>18710504</td>\n",
       "      <td>0</td>\n",
       "      <td>FOR01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>200.0</td>\n",
       "      <td>120.0</td>\n",
       "      <td>None</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>WS3187105050</td>\n",
       "      <td>18710505</td>\n",
       "      <td>0</td>\n",
       "      <td>WAS01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>HTBF</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>RC1187105060</td>\n",
       "      <td>18710506</td>\n",
       "      <td>0</td>\n",
       "      <td>RCK01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>None</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CH1187105080</td>\n",
       "      <td>18710508</td>\n",
       "      <td>0</td>\n",
       "      <td>CHI01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>None</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>TRO187105090</td>\n",
       "      <td>18710509</td>\n",
       "      <td>0</td>\n",
       "      <td>TRO01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>3250.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>HTBF</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>CL1187105110</td>\n",
       "      <td>18710511</td>\n",
       "      <td>0</td>\n",
       "      <td>CLE01</td>\n",
       "      <td>48.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>V</td>\n",
       "      <td>None</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>120.0</td>\n",
       "      <td>None</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>CL1187105130</td>\n",
       "      <td>18710513</td>\n",
       "      <td>0</td>\n",
       "      <td>CIN01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>1200.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>None</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>FW1187105130</td>\n",
       "      <td>18710513</td>\n",
       "      <td>0</td>\n",
       "      <td>FOR01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>105.0</td>\n",
       "      <td>None</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>FW1187105150</td>\n",
       "      <td>18710515</td>\n",
       "      <td>0</td>\n",
       "      <td>FOR01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>NaN</td>\n",
       "      <td>140.0</td>\n",
       "      <td>None</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>BS1187105160</td>\n",
       "      <td>18710516</td>\n",
       "      <td>0</td>\n",
       "      <td>BOS01</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>2500.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>HTBF</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        game_id      date  number_of_game park_id  length_outs day completion  \\\n",
       "0  FW1187105040  18710504               0   FOR01         54.0   D       None   \n",
       "1  WS3187105050  18710505               0   WAS01         54.0   D       None   \n",
       "2  RC1187105060  18710506               0   RCK01         54.0   D       None   \n",
       "3  CH1187105080  18710508               0   CHI01         54.0   D       None   \n",
       "4  TRO187105090  18710509               0   TRO01         54.0   D       None   \n",
       "5  CL1187105110  18710511               0   CLE01         48.0   D       None   \n",
       "6  CL1187105130  18710513               0   CIN01         54.0   D       None   \n",
       "7  FW1187105130  18710513               0   FOR01         54.0   D       None   \n",
       "8  FW1187105150  18710515               0   FOR01         54.0   D       None   \n",
       "9  BS1187105160  18710516               0   BOS01         54.0   D       None   \n",
       "\n",
       "  forefeit protest  attendance  length_minutes additional_info  \\\n",
       "0     None    None       200.0           120.0            None   \n",
       "1     None    None      5000.0           145.0            HTBF   \n",
       "2     None    None      1000.0           140.0            None   \n",
       "3     None    None      5000.0           150.0            None   \n",
       "4     None    None      3250.0           145.0            HTBF   \n",
       "5        V    None      2500.0           120.0            None   \n",
       "6     None    None      1200.0           150.0            None   \n",
       "7     None    None      1500.0           105.0            None   \n",
       "8     None    None         NaN           140.0            None   \n",
       "9     None    None      2500.0             NaN            HTBF   \n",
       "\n",
       "  acquisition_info  \n",
       "0                Y  \n",
       "1                Y  \n",
       "2                Y  \n",
       "3                Y  \n",
       "4                Y  \n",
       "5                Y  \n",
       "6                Y  \n",
       "7                Y  \n",
       "8                Y  \n",
       "9                Y  "
      ]
     },
     "execution_count": 130,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM game LIMIT 10'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>sql</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CREATE TABLE \"game_log\" (\\n\"date\" INTEGER,\\n  \"number_of_game\" INTEGER,\\n  \"day_of_week\" TEXT,\\n  \"v_name\" TEXT,\\n  \"v_league\" TEXT,\\n  \"v_game_number\" INTEGER,\\n  \"h_name\" TEXT,\\n  \"h_league\" TEXT,\\n  \"h_game_number\" INTEGER,\\n  \"v_score\" INTEGER,\\n  \"h_score\" INTEGER,\\n  \"length_outs\" REAL,\\n  \"day_night\" TEXT,\\n  \"completion\" TEXT,\\n  \"forefeit\" TEXT,\\n  \"protest\" TEXT,\\n  \"park_id\" TEXT,\\n  \"attendance\" REAL,\\n  \"length_minutes\" REAL,\\n  \"v_line_score\" TEXT,\\n  \"h_line_score\" TEXT,\\n  \"v_at_bats\" REAL,\\n  \"v_hits\" REAL,\\n  \"v_doubles\" REAL,\\n  \"v_triples\" REAL,\\n  \"v_homeruns\" REAL,\\n  \"v_rbi\" REAL,\\n  \"v_sacrifice_hits\" REAL,\\n  \"v_sacrifice_flies\" REAL,\\n  \"v_hit_by_pitch\" REAL,\\n  \"v_walks\" REAL,\\n  \"v_intentional_walks\" REAL,\\n  \"v_strikeouts\" REAL,\\n  \"v_stolen_bases\" REAL,\\n  \"v_caught_stealing\" REAL,\\n  \"v_grounded_into_double\" REAL,\\n  \"v_first_catcher_interference\" REAL,\\n  \"v_left_on_base\" REAL,\\n  \"v_pitchers_used\" REAL,\\n  \"v_individual_earned_runs\" REAL,\\n  \"v_team_earned_runs\" REAL,\\n  \"v_wild_pitches\" REAL,\\n  \"v_balks\" REAL,\\n  \"v_putouts\" REAL,\\n  \"v_assists\" REAL,\\n  \"v_errors\" REAL,\\n  \"v_passed_balls\" REAL,\\n  \"v_double_plays\" REAL,\\n  \"v_triple_plays\" REAL,\\n  \"h_at_bats\" REAL,\\n  \"h_hits\" REAL,\\n  \"h_doubles\" REAL,\\n  \"h_triples\" REAL,\\n  \"h_homeruns\" REAL,\\n  \"h_rbi\" REAL,\\n  \"h_sacrifice_hits\" REAL,\\n  \"h_sacrifice_flies\" REAL,\\n  \"h_hit_by_pitch\" REAL,\\n  \"h_walks\" REAL,\\n  \"h_intentional_walks\" REAL,\\n  \"h_strikeouts\" REAL,\\n  \"h_stolen_bases\" REAL,\\n  \"h_caught_stealing\" REAL,\\n  \"h_grounded_into_double\" REAL,\\n  \"h_first_catcher_interference\" REAL,\\n  \"h_left_on_base\" REAL,\\n  \"h_pitchers_used\" REAL,\\n  \"h_individual_earned_runs\" REAL,\\n  \"h_team_earned_runs\" REAL,\\n  \"h_wild_pitches\" REAL,\\n  \"h_balks\" REAL,\\n  \"h_putouts\" REAL,\\n  \"h_assists\" REAL,\\n  \"h_errors\" REAL,\\n  \"h_passed_balls\" REAL,\\n  \"h_double_plays\" REAL,\\n  \"h_triple_plays\" REAL,\\n  \"hp_umpire_id\" TEXT,\\n  \"hp_umpire_name\" TEXT,\\n  \"1b_umpire_id\" TEXT,\\n  \"1b_umpire_name\" TEXT,\\n  \"2b_umpire_id\" TEXT,\\n  \"2b_umpire_name\" TEXT,\\n  \"3b_umpire_id\" TEXT,\\n  \"3b_umpire_name\" TEXT,\\n  \"lf_umpire_id\" TEXT,\\n  \"lf_umpire_name\" TEXT,\\n  \"rf_umpire_id\" TEXT,\\n  \"rf_umpire_name\" TEXT,\\n  \"v_manager_id\" TEXT,\\n  \"v_manager_name\" TEXT,\\n  \"h_manager_id\" TEXT,\\n  \"h_manager_name\" TEXT,\\n  \"winning_pitcher_id\" TEXT,\\n  \"winning_pitcher_name\" TEXT,\\n  \"losing_pitcher_id\" TEXT,\\n  \"losing_pitcher_name\" TEXT,\\n  \"saving_pitcher_id\" TEXT,\\n  \"saving_pitcher_name\" TEXT,\\n  \"winning_rbi_batter_id\" TEXT,\\n  \"winning_rbi_batter_id_name\" TEXT,\\n  \"v_starting_pitcher_id\" TEXT,\\n  \"v_starting_pitcher_name\" TEXT,\\n  \"h_starting_pitcher_id\" TEXT,\\n  \"h_starting_pitcher_name\" TEXT,\\n  \"v_player_1_id\" TEXT,\\n  \"v_player_1_name\" TEXT,\\n  \"v_player_1_def_pos\" REAL,\\n  \"v_player_2_id\" TEXT,\\n  \"v_player_2_name\" TEXT,\\n  \"v_player_2_def_pos\" REAL,\\n  \"v_player_3_id\" TEXT,\\n  \"v_player_3_name\" TEXT,\\n  \"v_player_3_def_pos\" REAL,\\n  \"v_player_4_id\" TEXT,\\n  \"v_player_4_name\" TEXT,\\n  \"v_player_4_def_pos\" REAL,\\n  \"v_player_5_id\" TEXT,\\n  \"v_player_5_name\" TEXT,\\n  \"v_player_5_def_pos\" REAL,\\n  \"v_player_6_id\" TEXT,\\n  \"v_player_6_name\" TEXT,\\n  \"v_player_6_def_pos\" REAL,\\n  \"v_player_7_id\" TEXT,\\n  \"v_player_7_name\" TEXT,\\n  \"v_player_7_def_pos\" REAL,\\n  \"v_player_8_id\" TEXT,\\n  \"v_player_8_name\" TEXT,\\n  \"v_player_8_def_pos\" REAL,\\n  \"v_player_9_id\" TEXT,\\n  \"v_player_9_name\" TEXT,\\n  \"v_player_9_def_pos\" REAL,\\n  \"h_player_1_id\" TEXT,\\n  \"h_player_1_name\" TEXT,\\n  \"h_player_1_def_pos\" REAL,\\n  \"h_player_2_id\" TEXT,\\n  \"h_player_2_name\" TEXT,\\n  \"h_player_2_def_pos\" REAL,\\n  \"h_player_3_id\" TEXT,\\n  \"h_player_3_name\" TEXT,\\n  \"h_player_3_def_pos\" REAL,\\n  \"h_player_4_id\" TEXT,\\n  \"h_player_4_name\" TEXT,\\n  \"h_player_4_def_pos\" REAL,\\n  \"h_player_5_id\" TEXT,\\n  \"h_player_5_name\" TEXT,\\n  \"h_player_5_def_pos\" REAL,\\n  \"h_player_6_id\" TEXT,\\n  \"h_player_6_name\" TEXT,\\n  \"h_player_6_def_pos\" REAL,\\n  \"h_player_7_id\" TEXT,\\n  \"h_player_7_name\" TEXT,\\n  \"h_player_7_def_pos\" REAL,\\n  \"h_player_8_id\" TEXT,\\n  \"h_player_8_name\" TEXT,\\n  \"h_player_8_def_pos\" REAL,\\n  \"h_player_9_id\" TEXT,\\n  \"h_player_9_name\" TEXT,\\n  \"h_player_9_def_pos\" REAL,\\n  \"additional_info\" TEXT,\\n  \"acquisition_info\" TEXT\\n, game_id)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sql\n",
       "0  CREATE TABLE \"game_log\" (\\n\"date\" INTEGER,\\n  \"number_of_game\" INTEGER,\\n  \"day_of_week\" TEXT,\\n  \"v_name\" TEXT,\\n  \"v_league\" TEXT,\\n  \"v_game_number\" INTEGER,\\n  \"h_name\" TEXT,\\n  \"h_league\" TEXT,\\n  \"h_game_number\" INTEGER,\\n  \"v_score\" INTEGER,\\n  \"h_score\" INTEGER,\\n  \"length_outs\" REAL,\\n  \"day_night\" TEXT,\\n  \"completion\" TEXT,\\n  \"forefeit\" TEXT,\\n  \"protest\" TEXT,\\n  \"park_id\" TEXT,\\n  \"attendance\" REAL,\\n  \"length_minutes\" REAL,\\n  \"v_line_score\" TEXT,\\n  \"h_line_score\" TEXT,\\n  \"v_at_bats\" REAL,\\n  \"v_hits\" REAL,\\n  \"v_doubles\" REAL,\\n  \"v_triples\" REAL,\\n  \"v_homeruns\" REAL,\\n  \"v_rbi\" REAL,\\n  \"v_sacrifice_hits\" REAL,\\n  \"v_sacrifice_flies\" REAL,\\n  \"v_hit_by_pitch\" REAL,\\n  \"v_walks\" REAL,\\n  \"v_intentional_walks\" REAL,\\n  \"v_strikeouts\" REAL,\\n  \"v_stolen_bases\" REAL,\\n  \"v_caught_stealing\" REAL,\\n  \"v_grounded_into_double\" REAL,\\n  \"v_first_catcher_interference\" REAL,\\n  \"v_left_on_base\" REAL,\\n  \"v_pitchers_used\" REAL,\\n  \"v_individual_earned_runs\" REAL,\\n  \"v_team_earned_runs\" REAL,\\n  \"v_wild_pitches\" REAL,\\n  \"v_balks\" REAL,\\n  \"v_putouts\" REAL,\\n  \"v_assists\" REAL,\\n  \"v_errors\" REAL,\\n  \"v_passed_balls\" REAL,\\n  \"v_double_plays\" REAL,\\n  \"v_triple_plays\" REAL,\\n  \"h_at_bats\" REAL,\\n  \"h_hits\" REAL,\\n  \"h_doubles\" REAL,\\n  \"h_triples\" REAL,\\n  \"h_homeruns\" REAL,\\n  \"h_rbi\" REAL,\\n  \"h_sacrifice_hits\" REAL,\\n  \"h_sacrifice_flies\" REAL,\\n  \"h_hit_by_pitch\" REAL,\\n  \"h_walks\" REAL,\\n  \"h_intentional_walks\" REAL,\\n  \"h_strikeouts\" REAL,\\n  \"h_stolen_bases\" REAL,\\n  \"h_caught_stealing\" REAL,\\n  \"h_grounded_into_double\" REAL,\\n  \"h_first_catcher_interference\" REAL,\\n  \"h_left_on_base\" REAL,\\n  \"h_pitchers_used\" REAL,\\n  \"h_individual_earned_runs\" REAL,\\n  \"h_team_earned_runs\" REAL,\\n  \"h_wild_pitches\" REAL,\\n  \"h_balks\" REAL,\\n  \"h_putouts\" REAL,\\n  \"h_assists\" REAL,\\n  \"h_errors\" REAL,\\n  \"h_passed_balls\" REAL,\\n  \"h_double_plays\" REAL,\\n  \"h_triple_plays\" REAL,\\n  \"hp_umpire_id\" TEXT,\\n  \"hp_umpire_name\" TEXT,\\n  \"1b_umpire_id\" TEXT,\\n  \"1b_umpire_name\" TEXT,\\n  \"2b_umpire_id\" TEXT,\\n  \"2b_umpire_name\" TEXT,\\n  \"3b_umpire_id\" TEXT,\\n  \"3b_umpire_name\" TEXT,\\n  \"lf_umpire_id\" TEXT,\\n  \"lf_umpire_name\" TEXT,\\n  \"rf_umpire_id\" TEXT,\\n  \"rf_umpire_name\" TEXT,\\n  \"v_manager_id\" TEXT,\\n  \"v_manager_name\" TEXT,\\n  \"h_manager_id\" TEXT,\\n  \"h_manager_name\" TEXT,\\n  \"winning_pitcher_id\" TEXT,\\n  \"winning_pitcher_name\" TEXT,\\n  \"losing_pitcher_id\" TEXT,\\n  \"losing_pitcher_name\" TEXT,\\n  \"saving_pitcher_id\" TEXT,\\n  \"saving_pitcher_name\" TEXT,\\n  \"winning_rbi_batter_id\" TEXT,\\n  \"winning_rbi_batter_id_name\" TEXT,\\n  \"v_starting_pitcher_id\" TEXT,\\n  \"v_starting_pitcher_name\" TEXT,\\n  \"h_starting_pitcher_id\" TEXT,\\n  \"h_starting_pitcher_name\" TEXT,\\n  \"v_player_1_id\" TEXT,\\n  \"v_player_1_name\" TEXT,\\n  \"v_player_1_def_pos\" REAL,\\n  \"v_player_2_id\" TEXT,\\n  \"v_player_2_name\" TEXT,\\n  \"v_player_2_def_pos\" REAL,\\n  \"v_player_3_id\" TEXT,\\n  \"v_player_3_name\" TEXT,\\n  \"v_player_3_def_pos\" REAL,\\n  \"v_player_4_id\" TEXT,\\n  \"v_player_4_name\" TEXT,\\n  \"v_player_4_def_pos\" REAL,\\n  \"v_player_5_id\" TEXT,\\n  \"v_player_5_name\" TEXT,\\n  \"v_player_5_def_pos\" REAL,\\n  \"v_player_6_id\" TEXT,\\n  \"v_player_6_name\" TEXT,\\n  \"v_player_6_def_pos\" REAL,\\n  \"v_player_7_id\" TEXT,\\n  \"v_player_7_name\" TEXT,\\n  \"v_player_7_def_pos\" REAL,\\n  \"v_player_8_id\" TEXT,\\n  \"v_player_8_name\" TEXT,\\n  \"v_player_8_def_pos\" REAL,\\n  \"v_player_9_id\" TEXT,\\n  \"v_player_9_name\" TEXT,\\n  \"v_player_9_def_pos\" REAL,\\n  \"h_player_1_id\" TEXT,\\n  \"h_player_1_name\" TEXT,\\n  \"h_player_1_def_pos\" REAL,\\n  \"h_player_2_id\" TEXT,\\n  \"h_player_2_name\" TEXT,\\n  \"h_player_2_def_pos\" REAL,\\n  \"h_player_3_id\" TEXT,\\n  \"h_player_3_name\" TEXT,\\n  \"h_player_3_def_pos\" REAL,\\n  \"h_player_4_id\" TEXT,\\n  \"h_player_4_name\" TEXT,\\n  \"h_player_4_def_pos\" REAL,\\n  \"h_player_5_id\" TEXT,\\n  \"h_player_5_name\" TEXT,\\n  \"h_player_5_def_pos\" REAL,\\n  \"h_player_6_id\" TEXT,\\n  \"h_player_6_name\" TEXT,\\n  \"h_player_6_def_pos\" REAL,\\n  \"h_player_7_id\" TEXT,\\n  \"h_player_7_name\" TEXT,\\n  \"h_player_7_def_pos\" REAL,\\n  \"h_player_8_id\" TEXT,\\n  \"h_player_8_name\" TEXT,\\n  \"h_player_8_def_pos\" REAL,\\n  \"h_player_9_id\" TEXT,\\n  \"h_player_9_name\" TEXT,\\n  \"h_player_9_def_pos\" REAL,\\n  \"additional_info\" TEXT,\\n  \"acquisition_info\" TEXT\\n, game_id)"
      ]
     },
     "execution_count": 131,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "q5 = 'SELECT sql FROM sqlite_master WHERE name = \"game_log\" AND type = \"table\";'\n",
    "run_query(q5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "c14 = '''\n",
    "CREATE TABLE IF NOT EXISTS team_appearance\n",
    "(\n",
    "team_id TEXT,\n",
    "game_id TEXT,\n",
    "home INTEGER,\n",
    "league_id TEXT,\n",
    "score INTEGER,\n",
    "line_score TEXT,\n",
    "at_bats REAL,\n",
    "hits REAL,\n",
    "doubles REAL,\n",
    "triples REAL,\n",
    "homeruns REAL,\n",
    "rbi REAL,\n",
    "sacrifice_hits REAL,\n",
    "sacrifice_flies REAL,\n",
    "hit_by_pitch REAL,\n",
    "walks REAL,\n",
    "intentional_walks REAL,\n",
    "strikeouts REAL,\n",
    "stolen_bases REAL,\n",
    "caught_stealing REAL,\n",
    "grounded_into_double REAL,\n",
    "first_catcher_interference REAL,\n",
    "left_on_base REAL,\n",
    "pitchers_used REAL,\n",
    "individual_earned_runs REAL,\n",
    "team_earned_runs REAL,\n",
    "wild_pitches REAL,\n",
    "balks REAL,\n",
    "putouts REAL,\n",
    "assists REAL,\n",
    "errors REAL,\n",
    "passed_balls REAL,\n",
    "double_plays REAL,\n",
    "triple_plays REAL,\n",
    "PRIMARY KEY (team_id, game_id),\n",
    "FOREIGN KEY (league_id) REFERENCES league(league_id)\n",
    ");'''\n",
    "run_command(c14)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 133,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c15 = '''\n",
    "INSERT OR IGNORE INTO team_appearance\n",
    "    SELECT\n",
    "        h_name,\n",
    "        game_id,\n",
    "        1 AS home,\n",
    "        h_league,\n",
    "        h_score,\n",
    "        h_line_score,\n",
    "        h_at_bats,\n",
    "        h_hits,\n",
    "        h_doubles,\n",
    "        h_triples,\n",
    "        h_homeruns,\n",
    "        h_rbi,\n",
    "        h_sacrifice_hits,\n",
    "        h_sacrifice_flies,\n",
    "        h_hit_by_pitch,\n",
    "        h_walks,\n",
    "        h_intentional_walks,\n",
    "        h_strikeouts,\n",
    "        h_stolen_bases,\n",
    "        h_caught_stealing,\n",
    "        h_grounded_into_double,\n",
    "        h_first_catcher_interference,\n",
    "        h_left_on_base,\n",
    "        h_pitchers_used,\n",
    "        h_individual_earned_runs,\n",
    "        h_team_earned_runs,\n",
    "        h_wild_pitches,\n",
    "        h_balks,\n",
    "        h_putouts,\n",
    "        h_assists,\n",
    "        h_errors,\n",
    "        h_passed_balls,\n",
    "        h_double_plays,\n",
    "        h_triple_plays\n",
    "    FROM game_log\n",
    "\n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        v_name,\n",
    "        game_id,\n",
    "        0 AS home,\n",
    "        v_league,\n",
    "        v_score,\n",
    "        v_line_score,\n",
    "        v_at_bats,\n",
    "        v_hits,\n",
    "        v_doubles,\n",
    "        v_triples,\n",
    "        v_homeruns,\n",
    "        v_rbi,\n",
    "        v_sacrifice_hits,\n",
    "        v_sacrifice_flies,\n",
    "        v_hit_by_pitch,\n",
    "        v_walks,\n",
    "        v_intentional_walks,\n",
    "        v_strikeouts,\n",
    "        v_stolen_bases,\n",
    "        v_caught_stealing,\n",
    "        v_grounded_into_double,\n",
    "        v_first_catcher_interference,\n",
    "        v_left_on_base,\n",
    "        v_pitchers_used,\n",
    "        v_individual_earned_runs,\n",
    "        v_team_earned_runs,\n",
    "        v_wild_pitches,\n",
    "        v_balks,\n",
    "        v_putouts,\n",
    "        v_assists,\n",
    "        v_errors,\n",
    "        v_passed_balls,\n",
    "        v_double_plays,\n",
    "        v_triple_plays\n",
    "    FROM game_log;\n",
    "'''\n",
    "run_command(c15)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>team_id</th>\n",
       "      <th>game_id</th>\n",
       "      <th>home</th>\n",
       "      <th>league_id</th>\n",
       "      <th>score</th>\n",
       "      <th>line_score</th>\n",
       "      <th>at_bats</th>\n",
       "      <th>hits</th>\n",
       "      <th>doubles</th>\n",
       "      <th>triples</th>\n",
       "      <th>homeruns</th>\n",
       "      <th>rbi</th>\n",
       "      <th>sacrifice_hits</th>\n",
       "      <th>sacrifice_flies</th>\n",
       "      <th>hit_by_pitch</th>\n",
       "      <th>walks</th>\n",
       "      <th>intentional_walks</th>\n",
       "      <th>strikeouts</th>\n",
       "      <th>stolen_bases</th>\n",
       "      <th>caught_stealing</th>\n",
       "      <th>grounded_into_double</th>\n",
       "      <th>first_catcher_interference</th>\n",
       "      <th>left_on_base</th>\n",
       "      <th>pitchers_used</th>\n",
       "      <th>individual_earned_runs</th>\n",
       "      <th>team_earned_runs</th>\n",
       "      <th>wild_pitches</th>\n",
       "      <th>balks</th>\n",
       "      <th>putouts</th>\n",
       "      <th>assists</th>\n",
       "      <th>errors</th>\n",
       "      <th>passed_balls</th>\n",
       "      <th>double_plays</th>\n",
       "      <th>triple_plays</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188404300</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>2</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405020</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>3</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405030</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>5</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405050</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>2</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405100</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>9</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405120</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>3</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405140</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>2</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405150</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>7</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405160</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>6</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>ALT</td>\n",
       "      <td>ALT188405170</td>\n",
       "      <td>1</td>\n",
       "      <td>UA</td>\n",
       "      <td>8</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  team_id       game_id  home league_id  score line_score at_bats  hits  \\\n",
       "0     ALT  ALT188404300     1        UA      2       None    None  None   \n",
       "1     ALT  ALT188405020     1        UA      3       None    None  None   \n",
       "2     ALT  ALT188405030     1        UA      5       None    None  None   \n",
       "3     ALT  ALT188405050     1        UA      2       None    None  None   \n",
       "4     ALT  ALT188405100     1        UA      9       None    None  None   \n",
       "5     ALT  ALT188405120     1        UA      3       None    None  None   \n",
       "6     ALT  ALT188405140     1        UA      2       None    None  None   \n",
       "7     ALT  ALT188405150     1        UA      7       None    None  None   \n",
       "8     ALT  ALT188405160     1        UA      6       None    None  None   \n",
       "9     ALT  ALT188405170     1        UA      8       None    None  None   \n",
       "\n",
       "  doubles triples homeruns   rbi sacrifice_hits sacrifice_flies hit_by_pitch  \\\n",
       "0    None    None     None  None           None            None         None   \n",
       "1    None    None     None  None           None            None         None   \n",
       "2    None    None     None  None           None            None         None   \n",
       "3    None    None     None  None           None            None         None   \n",
       "4    None    None     None  None           None            None         None   \n",
       "5    None    None     None  None           None            None         None   \n",
       "6    None    None     None  None           None            None         None   \n",
       "7    None    None     None  None           None            None         None   \n",
       "8    None    None     None  None           None            None         None   \n",
       "9    None    None     None  None           None            None         None   \n",
       "\n",
       "  walks intentional_walks strikeouts stolen_bases caught_stealing  \\\n",
       "0  None              None       None         None            None   \n",
       "1  None              None       None         None            None   \n",
       "2  None              None       None         None            None   \n",
       "3  None              None       None         None            None   \n",
       "4  None              None       None         None            None   \n",
       "5  None              None       None         None            None   \n",
       "6  None              None       None         None            None   \n",
       "7  None              None       None         None            None   \n",
       "8  None              None       None         None            None   \n",
       "9  None              None       None         None            None   \n",
       "\n",
       "  grounded_into_double first_catcher_interference left_on_base pitchers_used  \\\n",
       "0                 None                       None         None          None   \n",
       "1                 None                       None         None          None   \n",
       "2                 None                       None         None          None   \n",
       "3                 None                       None         None          None   \n",
       "4                 None                       None         None          None   \n",
       "5                 None                       None         None          None   \n",
       "6                 None                       None         None          None   \n",
       "7                 None                       None         None          None   \n",
       "8                 None                       None         None          None   \n",
       "9                 None                       None         None          None   \n",
       "\n",
       "  individual_earned_runs team_earned_runs wild_pitches balks putouts assists  \\\n",
       "0                   None             None         None  None    None    None   \n",
       "1                   None             None         None  None    None    None   \n",
       "2                   None             None         None  None    None    None   \n",
       "3                   None             None         None  None    None    None   \n",
       "4                   None             None         None  None    None    None   \n",
       "5                   None             None         None  None    None    None   \n",
       "6                   None             None         None  None    None    None   \n",
       "7                   None             None         None  None    None    None   \n",
       "8                   None             None         None  None    None    None   \n",
       "9                   None             None         None  None    None    None   \n",
       "\n",
       "  errors passed_balls double_plays triple_plays  \n",
       "0   None         None         None         None  \n",
       "1   None         None         None         None  \n",
       "2   None         None         None         None  \n",
       "3   None         None         None         None  \n",
       "4   None         None         None         None  \n",
       "5   None         None         None         None  \n",
       "6   None         None         None         None  \n",
       "7   None         None         None         None  \n",
       "8   None         None         None         None  \n",
       "9   None         None         None         None  "
      ]
     },
     "execution_count": 134,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM team_appearance LIMIT 10'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 135,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>number_of_game</th>\n",
       "      <th>day_of_week</th>\n",
       "      <th>v_name</th>\n",
       "      <th>v_league</th>\n",
       "      <th>v_game_number</th>\n",
       "      <th>h_name</th>\n",
       "      <th>h_league</th>\n",
       "      <th>h_game_number</th>\n",
       "      <th>v_score</th>\n",
       "      <th>h_score</th>\n",
       "      <th>length_outs</th>\n",
       "      <th>day_night</th>\n",
       "      <th>completion</th>\n",
       "      <th>forefeit</th>\n",
       "      <th>protest</th>\n",
       "      <th>park_id</th>\n",
       "      <th>attendance</th>\n",
       "      <th>length_minutes</th>\n",
       "      <th>v_line_score</th>\n",
       "      <th>h_line_score</th>\n",
       "      <th>v_at_bats</th>\n",
       "      <th>v_hits</th>\n",
       "      <th>v_doubles</th>\n",
       "      <th>v_triples</th>\n",
       "      <th>v_homeruns</th>\n",
       "      <th>v_rbi</th>\n",
       "      <th>v_sacrifice_hits</th>\n",
       "      <th>v_sacrifice_flies</th>\n",
       "      <th>v_hit_by_pitch</th>\n",
       "      <th>v_walks</th>\n",
       "      <th>v_intentional_walks</th>\n",
       "      <th>v_strikeouts</th>\n",
       "      <th>v_stolen_bases</th>\n",
       "      <th>v_caught_stealing</th>\n",
       "      <th>v_grounded_into_double</th>\n",
       "      <th>v_first_catcher_interference</th>\n",
       "      <th>v_left_on_base</th>\n",
       "      <th>v_pitchers_used</th>\n",
       "      <th>v_individual_earned_runs</th>\n",
       "      <th>v_team_earned_runs</th>\n",
       "      <th>v_wild_pitches</th>\n",
       "      <th>v_balks</th>\n",
       "      <th>v_putouts</th>\n",
       "      <th>v_assists</th>\n",
       "      <th>v_errors</th>\n",
       "      <th>v_passed_balls</th>\n",
       "      <th>v_double_plays</th>\n",
       "      <th>v_triple_plays</th>\n",
       "      <th>h_at_bats</th>\n",
       "      <th>h_hits</th>\n",
       "      <th>h_doubles</th>\n",
       "      <th>h_triples</th>\n",
       "      <th>h_homeruns</th>\n",
       "      <th>h_rbi</th>\n",
       "      <th>h_sacrifice_hits</th>\n",
       "      <th>h_sacrifice_flies</th>\n",
       "      <th>h_hit_by_pitch</th>\n",
       "      <th>h_walks</th>\n",
       "      <th>h_intentional_walks</th>\n",
       "      <th>h_strikeouts</th>\n",
       "      <th>h_stolen_bases</th>\n",
       "      <th>h_caught_stealing</th>\n",
       "      <th>h_grounded_into_double</th>\n",
       "      <th>h_first_catcher_interference</th>\n",
       "      <th>h_left_on_base</th>\n",
       "      <th>h_pitchers_used</th>\n",
       "      <th>h_individual_earned_runs</th>\n",
       "      <th>h_team_earned_runs</th>\n",
       "      <th>h_wild_pitches</th>\n",
       "      <th>h_balks</th>\n",
       "      <th>h_putouts</th>\n",
       "      <th>h_assists</th>\n",
       "      <th>h_errors</th>\n",
       "      <th>h_passed_balls</th>\n",
       "      <th>h_double_plays</th>\n",
       "      <th>h_triple_plays</th>\n",
       "      <th>hp_umpire_id</th>\n",
       "      <th>hp_umpire_name</th>\n",
       "      <th>1b_umpire_id</th>\n",
       "      <th>1b_umpire_name</th>\n",
       "      <th>2b_umpire_id</th>\n",
       "      <th>2b_umpire_name</th>\n",
       "      <th>3b_umpire_id</th>\n",
       "      <th>3b_umpire_name</th>\n",
       "      <th>lf_umpire_id</th>\n",
       "      <th>lf_umpire_name</th>\n",
       "      <th>rf_umpire_id</th>\n",
       "      <th>rf_umpire_name</th>\n",
       "      <th>v_manager_id</th>\n",
       "      <th>v_manager_name</th>\n",
       "      <th>h_manager_id</th>\n",
       "      <th>h_manager_name</th>\n",
       "      <th>winning_pitcher_id</th>\n",
       "      <th>winning_pitcher_name</th>\n",
       "      <th>losing_pitcher_id</th>\n",
       "      <th>losing_pitcher_name</th>\n",
       "      <th>saving_pitcher_id</th>\n",
       "      <th>saving_pitcher_name</th>\n",
       "      <th>winning_rbi_batter_id</th>\n",
       "      <th>winning_rbi_batter_id_name</th>\n",
       "      <th>v_starting_pitcher_id</th>\n",
       "      <th>v_starting_pitcher_name</th>\n",
       "      <th>h_starting_pitcher_id</th>\n",
       "      <th>h_starting_pitcher_name</th>\n",
       "      <th>v_player_1_id</th>\n",
       "      <th>v_player_1_name</th>\n",
       "      <th>v_player_1_def_pos</th>\n",
       "      <th>v_player_2_id</th>\n",
       "      <th>v_player_2_name</th>\n",
       "      <th>v_player_2_def_pos</th>\n",
       "      <th>v_player_3_id</th>\n",
       "      <th>v_player_3_name</th>\n",
       "      <th>v_player_3_def_pos</th>\n",
       "      <th>v_player_4_id</th>\n",
       "      <th>v_player_4_name</th>\n",
       "      <th>v_player_4_def_pos</th>\n",
       "      <th>v_player_5_id</th>\n",
       "      <th>v_player_5_name</th>\n",
       "      <th>v_player_5_def_pos</th>\n",
       "      <th>v_player_6_id</th>\n",
       "      <th>v_player_6_name</th>\n",
       "      <th>v_player_6_def_pos</th>\n",
       "      <th>v_player_7_id</th>\n",
       "      <th>v_player_7_name</th>\n",
       "      <th>v_player_7_def_pos</th>\n",
       "      <th>v_player_8_id</th>\n",
       "      <th>v_player_8_name</th>\n",
       "      <th>v_player_8_def_pos</th>\n",
       "      <th>v_player_9_id</th>\n",
       "      <th>v_player_9_name</th>\n",
       "      <th>v_player_9_def_pos</th>\n",
       "      <th>h_player_1_id</th>\n",
       "      <th>h_player_1_name</th>\n",
       "      <th>h_player_1_def_pos</th>\n",
       "      <th>h_player_2_id</th>\n",
       "      <th>h_player_2_name</th>\n",
       "      <th>h_player_2_def_pos</th>\n",
       "      <th>h_player_3_id</th>\n",
       "      <th>h_player_3_name</th>\n",
       "      <th>h_player_3_def_pos</th>\n",
       "      <th>h_player_4_id</th>\n",
       "      <th>h_player_4_name</th>\n",
       "      <th>h_player_4_def_pos</th>\n",
       "      <th>h_player_5_id</th>\n",
       "      <th>h_player_5_name</th>\n",
       "      <th>h_player_5_def_pos</th>\n",
       "      <th>h_player_6_id</th>\n",
       "      <th>h_player_6_name</th>\n",
       "      <th>h_player_6_def_pos</th>\n",
       "      <th>h_player_7_id</th>\n",
       "      <th>h_player_7_name</th>\n",
       "      <th>h_player_7_def_pos</th>\n",
       "      <th>h_player_8_id</th>\n",
       "      <th>h_player_8_name</th>\n",
       "      <th>h_player_8_def_pos</th>\n",
       "      <th>h_player_9_id</th>\n",
       "      <th>h_player_9_name</th>\n",
       "      <th>h_player_9_def_pos</th>\n",
       "      <th>additional_info</th>\n",
       "      <th>acquisition_info</th>\n",
       "      <th>game_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>18840430</td>\n",
       "      <td>0</td>\n",
       "      <td>Wed</td>\n",
       "      <td>SLU</td>\n",
       "      <td>UA</td>\n",
       "      <td>6</td>\n",
       "      <td>ALT</td>\n",
       "      <td>UA</td>\n",
       "      <td>8</td>\n",
       "      <td>15</td>\n",
       "      <td>2</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>ALT01</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>maplb901</td>\n",
       "      <td>Blake Mapledoram</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>sullt101</td>\n",
       "      <td>Ted Sullivan</td>\n",
       "      <td>curte801</td>\n",
       "      <td>Ed Curtis</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>hodnc101</td>\n",
       "      <td>Hodnett</td>\n",
       "      <td>murpj104</td>\n",
       "      <td>Murphy</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "      <td>ALT188404300</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       date  number_of_game day_of_week v_name v_league  v_game_number h_name  \\\n",
       "0  18840430               0         Wed    SLU       UA              6    ALT   \n",
       "\n",
       "  h_league  h_game_number  v_score  h_score length_outs day_night completion  \\\n",
       "0       UA              8       15        2        None      None       None   \n",
       "\n",
       "  forefeit protest park_id attendance length_minutes v_line_score  \\\n",
       "0     None    None   ALT01       None           None         None   \n",
       "\n",
       "  h_line_score v_at_bats v_hits v_doubles v_triples v_homeruns v_rbi  \\\n",
       "0         None      None   None      None      None       None  None   \n",
       "\n",
       "  v_sacrifice_hits v_sacrifice_flies v_hit_by_pitch v_walks  \\\n",
       "0             None              None           None    None   \n",
       "\n",
       "  v_intentional_walks v_strikeouts v_stolen_bases v_caught_stealing  \\\n",
       "0                None         None           None              None   \n",
       "\n",
       "  v_grounded_into_double v_first_catcher_interference v_left_on_base  \\\n",
       "0                   None                         None           None   \n",
       "\n",
       "  v_pitchers_used v_individual_earned_runs v_team_earned_runs v_wild_pitches  \\\n",
       "0            None                     None               None           None   \n",
       "\n",
       "  v_balks v_putouts v_assists v_errors v_passed_balls v_double_plays  \\\n",
       "0    None      None      None     None           None           None   \n",
       "\n",
       "  v_triple_plays h_at_bats h_hits h_doubles h_triples h_homeruns h_rbi  \\\n",
       "0           None      None   None      None      None       None  None   \n",
       "\n",
       "  h_sacrifice_hits h_sacrifice_flies h_hit_by_pitch h_walks  \\\n",
       "0             None              None           None    None   \n",
       "\n",
       "  h_intentional_walks h_strikeouts h_stolen_bases h_caught_stealing  \\\n",
       "0                None         None           None              None   \n",
       "\n",
       "  h_grounded_into_double h_first_catcher_interference h_left_on_base  \\\n",
       "0                   None                         None           None   \n",
       "\n",
       "  h_pitchers_used h_individual_earned_runs h_team_earned_runs h_wild_pitches  \\\n",
       "0            None                     None               None           None   \n",
       "\n",
       "  h_balks h_putouts h_assists h_errors h_passed_balls h_double_plays  \\\n",
       "0    None      None      None     None           None           None   \n",
       "\n",
       "  h_triple_plays hp_umpire_id    hp_umpire_name 1b_umpire_id 1b_umpire_name  \\\n",
       "0           None     maplb901  Blake Mapledoram         None           None   \n",
       "\n",
       "  2b_umpire_id 2b_umpire_name 3b_umpire_id 3b_umpire_name lf_umpire_id  \\\n",
       "0         None           None         None           None         None   \n",
       "\n",
       "  lf_umpire_name rf_umpire_id rf_umpire_name v_manager_id v_manager_name  \\\n",
       "0           None         None           None     sullt101   Ted Sullivan   \n",
       "\n",
       "  h_manager_id h_manager_name winning_pitcher_id winning_pitcher_name  \\\n",
       "0     curte801      Ed Curtis               None                 None   \n",
       "\n",
       "  losing_pitcher_id losing_pitcher_name saving_pitcher_id saving_pitcher_name  \\\n",
       "0              None                None              None                None   \n",
       "\n",
       "  winning_rbi_batter_id winning_rbi_batter_id_name v_starting_pitcher_id  \\\n",
       "0                  None                       None              hodnc101   \n",
       "\n",
       "  v_starting_pitcher_name h_starting_pitcher_id h_starting_pitcher_name  \\\n",
       "0                 Hodnett              murpj104                  Murphy   \n",
       "\n",
       "  v_player_1_id v_player_1_name v_player_1_def_pos v_player_2_id  \\\n",
       "0          None            None               None          None   \n",
       "\n",
       "  v_player_2_name v_player_2_def_pos v_player_3_id v_player_3_name  \\\n",
       "0            None               None          None            None   \n",
       "\n",
       "  v_player_3_def_pos v_player_4_id v_player_4_name v_player_4_def_pos  \\\n",
       "0               None          None            None               None   \n",
       "\n",
       "  v_player_5_id v_player_5_name v_player_5_def_pos v_player_6_id  \\\n",
       "0          None            None               None          None   \n",
       "\n",
       "  v_player_6_name v_player_6_def_pos v_player_7_id v_player_7_name  \\\n",
       "0            None               None          None            None   \n",
       "\n",
       "  v_player_7_def_pos v_player_8_id v_player_8_name v_player_8_def_pos  \\\n",
       "0               None          None            None               None   \n",
       "\n",
       "  v_player_9_id v_player_9_name v_player_9_def_pos h_player_1_id  \\\n",
       "0          None            None               None          None   \n",
       "\n",
       "  h_player_1_name h_player_1_def_pos h_player_2_id h_player_2_name  \\\n",
       "0            None               None          None            None   \n",
       "\n",
       "  h_player_2_def_pos h_player_3_id h_player_3_name h_player_3_def_pos  \\\n",
       "0               None          None            None               None   \n",
       "\n",
       "  h_player_4_id h_player_4_name h_player_4_def_pos h_player_5_id  \\\n",
       "0          None            None               None          None   \n",
       "\n",
       "  h_player_5_name h_player_5_def_pos h_player_6_id h_player_6_name  \\\n",
       "0            None               None          None            None   \n",
       "\n",
       "  h_player_6_def_pos h_player_7_id h_player_7_name h_player_7_def_pos  \\\n",
       "0               None          None            None               None   \n",
       "\n",
       "  h_player_8_id h_player_8_name h_player_8_def_pos h_player_9_id  \\\n",
       "0          None            None               None          None   \n",
       "\n",
       "  h_player_9_name h_player_9_def_pos additional_info acquisition_info  \\\n",
       "0            None               None            None             None   \n",
       "\n",
       "        game_id  \n",
       "0  ALT188404300  "
      ]
     },
     "execution_count": 135,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "qq = 'SELECT * FROM game_log WHERE game_id = \"ALT188404300\"'\n",
    "run_query(qq)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 136,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "cc = \"DROP TABLE IF EXISTS person_appearance\"\n",
    "run_command(cc)\n",
    "\n",
    "c16 = '''\n",
    "CREATE TABLE person_appearance\n",
    "(\n",
    "appearance_id INTEGER PRIMARY KEY,\n",
    "person_id TEXT,\n",
    "team_id TEXT,\n",
    "game_id TEXT,\n",
    "appearance_type_id TEXT,\n",
    "FOREIGN KEY (person_id) REFERENCES person(person_id),\n",
    "FOREIGN KEY (team_id) REFERENCES team(team_id),\n",
    "FOREIGN KEY (game_id) REFERENCES game(game_id),\n",
    "FOREIGN KEY (appearance_type_id) REFERENCES appearance_type(appearance_type_id)\n",
    ");'''\n",
    "run_command(c16)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 137,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Field(s)  Meaning\r\n",
      "    1     Date in the form \"yyyymmdd\"\r\n",
      "    2     Number of game:\r\n",
      "             \"0\" -- a single game\r\n",
      "             \"1\" -- the first game of a double (or triple) header\r\n",
      "                    including seperate admission doubleheaders\r\n",
      "             \"2\" -- the second game of a double (or triple) header\r\n",
      "                    including seperate admission doubleheaders\r\n",
      "             \"3\" -- the third game of a triple-header\r\n",
      "             \"A\" -- the first game of a double-header involving 3 teams\r\n",
      "             \"B\" -- the second game of a double-header involving 3 teams\r\n",
      "    3     Day of week  (\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\")\r\n",
      "  4-5     Visiting team and league\r\n",
      "    6     Visiting team game number\r\n",
      "          For this and the home team game number, ties are counted as\r\n",
      "          games and suspended games are counted from the starting\r\n",
      "          rather than the ending date.\r\n",
      "  7-8     Home team and league\r\n",
      "    9     Home team game number\r\n",
      "10-11     Visiting and home team score (unquoted)\r\n",
      "   12     Length of game in outs (unquoted).  A full 9-inning game would\r\n",
      "          have a 54 in this field.  If the home team won without batting\r\n",
      "          in the bottom of the ninth, this field would contain a 51.\r\n",
      "   13     Day/night indicator (\"D\" or \"N\")\r\n",
      "   14     Completion information.  If the game was completed at a\r\n",
      "          later date (either due to a suspension or an upheld protest)\r\n",
      "          this field will include:\r\n",
      "             \"yyyymmdd,park,vs,hs,len\" Where\r\n",
      "          yyyymmdd -- the date the game was completed\r\n",
      "          park -- the park ID where the game was completed\r\n",
      "          vs -- the visitor score at the time of interruption\r\n",
      "          hs -- the home score at the time of interruption\r\n",
      "          len -- the length of the game in outs at time of interruption\r\n",
      "          All the rest of the information in the record refers to the\r\n",
      "          entire game.\r\n",
      "   15     Forfeit information:\r\n",
      "             \"V\" -- the game was forfeited to the visiting team\r\n",
      "             \"H\" -- the game was forfeited to the home team\r\n",
      "             \"T\" -- the game was ruled a no-decision\r\n",
      "   16     Protest information:\r\n",
      "             \"P\" -- the game was protested by an unidentified team\r\n",
      "             \"V\" -- a disallowed protest was made by the visiting team\r\n",
      "             \"H\" -- a disallowed protest was made by the home team\r\n",
      "             \"X\" -- an upheld protest was made by the visiting team\r\n",
      "             \"Y\" -- an upheld protest was made by the home team\r\n",
      "          Note: two of these last four codes can appear in the field\r\n",
      "          (if both teams protested the game).\r\n",
      "   17     Park ID\r\n",
      "   18     Attendance (unquoted)\r\n",
      "   19     Time of game in minutes (unquoted)\r\n",
      "20-21     Visiting and home line scores.  For example:\r\n",
      "             \"010000(10)0x\"\r\n",
      "          Would indicate a game where the home team scored a run in\r\n",
      "          the second inning, ten in the seventh and didn't bat in the\r\n",
      "          bottom of the ninth.\r\n",
      "22-38     Visiting team offensive statistics (unquoted) (in order):\r\n",
      "             at-bats\r\n",
      "             hits\r\n",
      "             doubles\r\n",
      "             triples\r\n",
      "             homeruns\r\n",
      "             RBI\r\n",
      "             sacrifice hits.  This may include sacrifice flies for years\r\n",
      "                prior to 1954 when sacrifice flies were allowed.\r\n",
      "             sacrifice flies (since 1954)\r\n",
      "             hit-by-pitch\r\n",
      "             walks\r\n",
      "             intentional walks\r\n",
      "             strikeouts\r\n",
      "             stolen bases\r\n",
      "             caught stealing\r\n",
      "             grounded into double plays\r\n",
      "             awarded first on catcher's interference\r\n",
      "             left on base\r\n",
      "39-43     Visiting team pitching statistics (unquoted)(in order):\r\n",
      "             pitchers used ( 1 means it was a complete game )\r\n",
      "             individual earned runs\r\n",
      "             team earned runs\r\n",
      "             wild pitches\r\n",
      "             balks\r\n",
      "44-49     Visiting team defensive statistics (unquoted) (in order):\r\n",
      "             putouts.  Note: prior to 1931, this may not equal 3 times\r\n",
      "                the number of innings pitched.  Prior to that, no\r\n",
      "                putout was awarded when a runner was declared out for\r\n",
      "                being hit by a batted ball.\r\n",
      "             assists\r\n",
      "             errors\r\n",
      "             passed balls\r\n",
      "             double plays\r\n",
      "             triple plays\r\n",
      "50-66     Home team offensive statistics\r\n",
      "67-71     Home team pitching statistics\r\n",
      "72-77     Home team defensive statistics\r\n",
      "78-79     Home plate umpire ID and name\r\n",
      "80-81     1B umpire ID and name\r\n",
      "82-83     2B umpire ID and name\r\n",
      "84-85     3B umpire ID and name\r\n",
      "86-87     LF umpire ID and name\r\n",
      "88-89     RF umpire ID and name\r\n",
      "          If any umpire positions were not filled for a particular game\r\n",
      "          the fields will be \"\",\"(none)\".\r\n",
      "90-91     Visiting team manager ID and name\r\n",
      "92-93     Home team manager ID and name\r\n",
      "94-95     Winning pitcher ID and name\r\n",
      "96-97     Losing pitcher ID and name\r\n",
      "98-99     Saving pitcher ID and name--\"\",\"(none)\" if none awarded\r\n",
      "100-101   Game Winning RBI batter ID and name--\"\",\"(none)\" if none\r\n",
      "          awarded\r\n",
      "102-103   Visiting starting pitcher ID and name\r\n",
      "104-105   Home starting pitcher ID and name\r\n",
      "106-132   Visiting starting players ID, name and defensive position,\r\n",
      "          listed in the order (1-9) they appeared in the batting order.\r\n",
      "133-159   Home starting players ID, name and defensive position\r\n",
      "          listed in the order (1-9) they appeared in the batting order.\r\n",
      "  160     Additional information.  This is a grab-bag of informational\r\n",
      "          items that might not warrant a field on their own.  The field \r\n",
      "          is alpha-numeric. Some items are represented by tokens such as:\r\n",
      "             \"HTBF\" -- home team batted first.\r\n",
      "             Note: if \"HTBF\" is specified it would be possible to see\r\n",
      "             something like \"01002000x\" in the visitor's line score.\r\n",
      "          Changes in umpire positions during a game will also appear in \r\n",
      "          this field.  These will be in the form:\r\n",
      "             umpchange,inning,umpPosition,umpid with the latter three\r\n",
      "             repeated for each umpire.\r\n",
      "          These changes occur with umpire injuries, late arrival of \r\n",
      "          umpires or changes from completion of suspended games. Details\r\n",
      "          of suspended games are in field 14.\r\n",
      "  161     Acquisition information:\r\n",
      "             \"Y\" -- we have the complete game\r\n",
      "             \"N\" -- we don't have any portion of the game\r\n",
      "             \"D\" -- the game was derived from box score and game story\r\n",
      "             \"P\" -- we have some portion of the game.  We may be missing\r\n",
      "                    innings at the beginning, middle and end of the game.\r\n",
      " \r\n",
      "Missing fields will be NULL.\r\n",
      "\u001a"
     ]
    }
   ],
   "source": [
    "!cat game_log_fields.txt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 138,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>number_of_game</th>\n",
       "      <th>day_of_week</th>\n",
       "      <th>v_name</th>\n",
       "      <th>v_league</th>\n",
       "      <th>v_game_number</th>\n",
       "      <th>h_name</th>\n",
       "      <th>h_league</th>\n",
       "      <th>h_game_number</th>\n",
       "      <th>v_score</th>\n",
       "      <th>h_score</th>\n",
       "      <th>length_outs</th>\n",
       "      <th>day_night</th>\n",
       "      <th>completion</th>\n",
       "      <th>forefeit</th>\n",
       "      <th>protest</th>\n",
       "      <th>park_id</th>\n",
       "      <th>attendance</th>\n",
       "      <th>length_minutes</th>\n",
       "      <th>v_line_score</th>\n",
       "      <th>h_line_score</th>\n",
       "      <th>v_at_bats</th>\n",
       "      <th>v_hits</th>\n",
       "      <th>v_doubles</th>\n",
       "      <th>v_triples</th>\n",
       "      <th>v_homeruns</th>\n",
       "      <th>v_rbi</th>\n",
       "      <th>v_sacrifice_hits</th>\n",
       "      <th>v_sacrifice_flies</th>\n",
       "      <th>v_hit_by_pitch</th>\n",
       "      <th>v_walks</th>\n",
       "      <th>v_intentional_walks</th>\n",
       "      <th>v_strikeouts</th>\n",
       "      <th>v_stolen_bases</th>\n",
       "      <th>v_caught_stealing</th>\n",
       "      <th>v_grounded_into_double</th>\n",
       "      <th>v_first_catcher_interference</th>\n",
       "      <th>v_left_on_base</th>\n",
       "      <th>v_pitchers_used</th>\n",
       "      <th>v_individual_earned_runs</th>\n",
       "      <th>v_team_earned_runs</th>\n",
       "      <th>v_wild_pitches</th>\n",
       "      <th>v_balks</th>\n",
       "      <th>v_putouts</th>\n",
       "      <th>v_assists</th>\n",
       "      <th>v_errors</th>\n",
       "      <th>v_passed_balls</th>\n",
       "      <th>v_double_plays</th>\n",
       "      <th>v_triple_plays</th>\n",
       "      <th>h_at_bats</th>\n",
       "      <th>h_hits</th>\n",
       "      <th>h_doubles</th>\n",
       "      <th>h_triples</th>\n",
       "      <th>h_homeruns</th>\n",
       "      <th>h_rbi</th>\n",
       "      <th>h_sacrifice_hits</th>\n",
       "      <th>h_sacrifice_flies</th>\n",
       "      <th>h_hit_by_pitch</th>\n",
       "      <th>h_walks</th>\n",
       "      <th>h_intentional_walks</th>\n",
       "      <th>h_strikeouts</th>\n",
       "      <th>h_stolen_bases</th>\n",
       "      <th>h_caught_stealing</th>\n",
       "      <th>h_grounded_into_double</th>\n",
       "      <th>h_first_catcher_interference</th>\n",
       "      <th>h_left_on_base</th>\n",
       "      <th>h_pitchers_used</th>\n",
       "      <th>h_individual_earned_runs</th>\n",
       "      <th>h_team_earned_runs</th>\n",
       "      <th>h_wild_pitches</th>\n",
       "      <th>h_balks</th>\n",
       "      <th>h_putouts</th>\n",
       "      <th>h_assists</th>\n",
       "      <th>h_errors</th>\n",
       "      <th>h_passed_balls</th>\n",
       "      <th>h_double_plays</th>\n",
       "      <th>h_triple_plays</th>\n",
       "      <th>hp_umpire_id</th>\n",
       "      <th>hp_umpire_name</th>\n",
       "      <th>1b_umpire_id</th>\n",
       "      <th>1b_umpire_name</th>\n",
       "      <th>2b_umpire_id</th>\n",
       "      <th>2b_umpire_name</th>\n",
       "      <th>3b_umpire_id</th>\n",
       "      <th>3b_umpire_name</th>\n",
       "      <th>lf_umpire_id</th>\n",
       "      <th>lf_umpire_name</th>\n",
       "      <th>rf_umpire_id</th>\n",
       "      <th>rf_umpire_name</th>\n",
       "      <th>v_manager_id</th>\n",
       "      <th>v_manager_name</th>\n",
       "      <th>h_manager_id</th>\n",
       "      <th>h_manager_name</th>\n",
       "      <th>winning_pitcher_id</th>\n",
       "      <th>winning_pitcher_name</th>\n",
       "      <th>losing_pitcher_id</th>\n",
       "      <th>losing_pitcher_name</th>\n",
       "      <th>saving_pitcher_id</th>\n",
       "      <th>saving_pitcher_name</th>\n",
       "      <th>winning_rbi_batter_id</th>\n",
       "      <th>winning_rbi_batter_id_name</th>\n",
       "      <th>v_starting_pitcher_id</th>\n",
       "      <th>v_starting_pitcher_name</th>\n",
       "      <th>h_starting_pitcher_id</th>\n",
       "      <th>h_starting_pitcher_name</th>\n",
       "      <th>v_player_1_id</th>\n",
       "      <th>v_player_1_name</th>\n",
       "      <th>v_player_1_def_pos</th>\n",
       "      <th>v_player_2_id</th>\n",
       "      <th>v_player_2_name</th>\n",
       "      <th>v_player_2_def_pos</th>\n",
       "      <th>v_player_3_id</th>\n",
       "      <th>v_player_3_name</th>\n",
       "      <th>v_player_3_def_pos</th>\n",
       "      <th>v_player_4_id</th>\n",
       "      <th>v_player_4_name</th>\n",
       "      <th>v_player_4_def_pos</th>\n",
       "      <th>v_player_5_id</th>\n",
       "      <th>v_player_5_name</th>\n",
       "      <th>v_player_5_def_pos</th>\n",
       "      <th>v_player_6_id</th>\n",
       "      <th>v_player_6_name</th>\n",
       "      <th>v_player_6_def_pos</th>\n",
       "      <th>v_player_7_id</th>\n",
       "      <th>v_player_7_name</th>\n",
       "      <th>v_player_7_def_pos</th>\n",
       "      <th>v_player_8_id</th>\n",
       "      <th>v_player_8_name</th>\n",
       "      <th>v_player_8_def_pos</th>\n",
       "      <th>v_player_9_id</th>\n",
       "      <th>v_player_9_name</th>\n",
       "      <th>v_player_9_def_pos</th>\n",
       "      <th>h_player_1_id</th>\n",
       "      <th>h_player_1_name</th>\n",
       "      <th>h_player_1_def_pos</th>\n",
       "      <th>h_player_2_id</th>\n",
       "      <th>h_player_2_name</th>\n",
       "      <th>h_player_2_def_pos</th>\n",
       "      <th>h_player_3_id</th>\n",
       "      <th>h_player_3_name</th>\n",
       "      <th>h_player_3_def_pos</th>\n",
       "      <th>h_player_4_id</th>\n",
       "      <th>h_player_4_name</th>\n",
       "      <th>h_player_4_def_pos</th>\n",
       "      <th>h_player_5_id</th>\n",
       "      <th>h_player_5_name</th>\n",
       "      <th>h_player_5_def_pos</th>\n",
       "      <th>h_player_6_id</th>\n",
       "      <th>h_player_6_name</th>\n",
       "      <th>h_player_6_def_pos</th>\n",
       "      <th>h_player_7_id</th>\n",
       "      <th>h_player_7_name</th>\n",
       "      <th>h_player_7_def_pos</th>\n",
       "      <th>h_player_8_id</th>\n",
       "      <th>h_player_8_name</th>\n",
       "      <th>h_player_8_def_pos</th>\n",
       "      <th>h_player_9_id</th>\n",
       "      <th>h_player_9_name</th>\n",
       "      <th>h_player_9_def_pos</th>\n",
       "      <th>additional_info</th>\n",
       "      <th>acquisition_info</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>18710504</td>\n",
       "      <td>0</td>\n",
       "      <td>Thu</td>\n",
       "      <td>CL1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>FW1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FOR01</td>\n",
       "      <td>200.0</td>\n",
       "      <td>120.0</td>\n",
       "      <td>000000000</td>\n",
       "      <td>010010000</td>\n",
       "      <td>30.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>boakj901</td>\n",
       "      <td>John Boake</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>lennb101</td>\n",
       "      <td>Bill Lennon</td>\n",
       "      <td>mathb101</td>\n",
       "      <td>Bobby Mathews</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>mathb101</td>\n",
       "      <td>Bobby Mathews</td>\n",
       "      <td>whitd102</td>\n",
       "      <td>Deacon White</td>\n",
       "      <td>2.0</td>\n",
       "      <td>kimbg101</td>\n",
       "      <td>Gene Kimball</td>\n",
       "      <td>4.0</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>7.0</td>\n",
       "      <td>allia101</td>\n",
       "      <td>Art Allison</td>\n",
       "      <td>8.0</td>\n",
       "      <td>white104</td>\n",
       "      <td>Elmer White</td>\n",
       "      <td>9.0</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>1.0</td>\n",
       "      <td>sutte101</td>\n",
       "      <td>Ezra Sutton</td>\n",
       "      <td>5.0</td>\n",
       "      <td>carlj102</td>\n",
       "      <td>Jim Carleton</td>\n",
       "      <td>3.0</td>\n",
       "      <td>bassj101</td>\n",
       "      <td>John Bass</td>\n",
       "      <td>6.0</td>\n",
       "      <td>selmf101</td>\n",
       "      <td>Frank Sellman</td>\n",
       "      <td>5.0</td>\n",
       "      <td>mathb101</td>\n",
       "      <td>Bobby Mathews</td>\n",
       "      <td>1.0</td>\n",
       "      <td>foraj101</td>\n",
       "      <td>Jim Foran</td>\n",
       "      <td>3.0</td>\n",
       "      <td>goldw101</td>\n",
       "      <td>Wally Goldsmith</td>\n",
       "      <td>6.0</td>\n",
       "      <td>lennb101</td>\n",
       "      <td>Bill Lennon</td>\n",
       "      <td>2.0</td>\n",
       "      <td>caret101</td>\n",
       "      <td>Tom Carey</td>\n",
       "      <td>4.0</td>\n",
       "      <td>mince101</td>\n",
       "      <td>Ed Mincher</td>\n",
       "      <td>7.0</td>\n",
       "      <td>mcdej101</td>\n",
       "      <td>James McDermott</td>\n",
       "      <td>8.0</td>\n",
       "      <td>kellb105</td>\n",
       "      <td>Bill Kelly</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>18710505</td>\n",
       "      <td>0</td>\n",
       "      <td>Fri</td>\n",
       "      <td>BS1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>WS3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>20</td>\n",
       "      <td>18</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>WAS01</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>107000435</td>\n",
       "      <td>640113030</td>\n",
       "      <td>41.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>dobsh901</td>\n",
       "      <td>Henry Dobson</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>younn801</td>\n",
       "      <td>Nick Young</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>braia102</td>\n",
       "      <td>Asa Brainard</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>braia102</td>\n",
       "      <td>Asa Brainard</td>\n",
       "      <td>wrigg101</td>\n",
       "      <td>George Wright</td>\n",
       "      <td>6.0</td>\n",
       "      <td>barnr102</td>\n",
       "      <td>Ross Barnes</td>\n",
       "      <td>4.0</td>\n",
       "      <td>birdd102</td>\n",
       "      <td>Dave Birdsall</td>\n",
       "      <td>9.0</td>\n",
       "      <td>mcvec101</td>\n",
       "      <td>Cal McVey</td>\n",
       "      <td>2.0</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>8.0</td>\n",
       "      <td>goulc101</td>\n",
       "      <td>Charlie Gould</td>\n",
       "      <td>3.0</td>\n",
       "      <td>schah101</td>\n",
       "      <td>Harry Schafer</td>\n",
       "      <td>5.0</td>\n",
       "      <td>conef101</td>\n",
       "      <td>Fred Cone</td>\n",
       "      <td>7.0</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>1.0</td>\n",
       "      <td>watef102</td>\n",
       "      <td>Fred Waterman</td>\n",
       "      <td>5.0</td>\n",
       "      <td>forcd101</td>\n",
       "      <td>Davy Force</td>\n",
       "      <td>6.0</td>\n",
       "      <td>mille105</td>\n",
       "      <td>Everett Mills</td>\n",
       "      <td>3.0</td>\n",
       "      <td>allid101</td>\n",
       "      <td>Doug Allison</td>\n",
       "      <td>2.0</td>\n",
       "      <td>hallg101</td>\n",
       "      <td>George Hall</td>\n",
       "      <td>7.0</td>\n",
       "      <td>leona101</td>\n",
       "      <td>Andy Leonard</td>\n",
       "      <td>4.0</td>\n",
       "      <td>braia102</td>\n",
       "      <td>Asa Brainard</td>\n",
       "      <td>1.0</td>\n",
       "      <td>burrh101</td>\n",
       "      <td>Henry Burroughs</td>\n",
       "      <td>9.0</td>\n",
       "      <td>berth101</td>\n",
       "      <td>Henry Berthrong</td>\n",
       "      <td>8.0</td>\n",
       "      <td>HTBF</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>18710506</td>\n",
       "      <td>0</td>\n",
       "      <td>Sat</td>\n",
       "      <td>CL1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>RC1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>4</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>RCK01</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>610020003</td>\n",
       "      <td>010020100</td>\n",
       "      <td>49.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>mawnj901</td>\n",
       "      <td>J.H. Manny</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>hasts101</td>\n",
       "      <td>Scott Hastings</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>fishc102</td>\n",
       "      <td>Cherokee Fisher</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>fishc102</td>\n",
       "      <td>Cherokee Fisher</td>\n",
       "      <td>whitd102</td>\n",
       "      <td>Deacon White</td>\n",
       "      <td>2.0</td>\n",
       "      <td>kimbg101</td>\n",
       "      <td>Gene Kimball</td>\n",
       "      <td>4.0</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>7.0</td>\n",
       "      <td>allia101</td>\n",
       "      <td>Art Allison</td>\n",
       "      <td>8.0</td>\n",
       "      <td>white104</td>\n",
       "      <td>Elmer White</td>\n",
       "      <td>9.0</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>1.0</td>\n",
       "      <td>sutte101</td>\n",
       "      <td>Ezra Sutton</td>\n",
       "      <td>5.0</td>\n",
       "      <td>carlj102</td>\n",
       "      <td>Jim Carleton</td>\n",
       "      <td>3.0</td>\n",
       "      <td>bassj101</td>\n",
       "      <td>John Bass</td>\n",
       "      <td>6.0</td>\n",
       "      <td>mackd101</td>\n",
       "      <td>Denny Mack</td>\n",
       "      <td>3.0</td>\n",
       "      <td>addyb101</td>\n",
       "      <td>Bob Addy</td>\n",
       "      <td>4.0</td>\n",
       "      <td>fishc102</td>\n",
       "      <td>Cherokee Fisher</td>\n",
       "      <td>1.0</td>\n",
       "      <td>hasts101</td>\n",
       "      <td>Scott Hastings</td>\n",
       "      <td>8.0</td>\n",
       "      <td>ham-r101</td>\n",
       "      <td>Ralph Ham</td>\n",
       "      <td>5.0</td>\n",
       "      <td>ansoc101</td>\n",
       "      <td>Cap Anson</td>\n",
       "      <td>2.0</td>\n",
       "      <td>sagep101</td>\n",
       "      <td>Pony Sager</td>\n",
       "      <td>6.0</td>\n",
       "      <td>birdg101</td>\n",
       "      <td>George Bird</td>\n",
       "      <td>7.0</td>\n",
       "      <td>stirg101</td>\n",
       "      <td>Gat Stires</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>18710508</td>\n",
       "      <td>0</td>\n",
       "      <td>Mon</td>\n",
       "      <td>CL1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "      <td>CH1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>14</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CHI01</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>101403111</td>\n",
       "      <td>077000000</td>\n",
       "      <td>46.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>willg901</td>\n",
       "      <td>Gardner Willard</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>woodj106</td>\n",
       "      <td>Jimmy Wood</td>\n",
       "      <td>zettg101</td>\n",
       "      <td>George Zettlein</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>zettg101</td>\n",
       "      <td>George Zettlein</td>\n",
       "      <td>whitd102</td>\n",
       "      <td>Deacon White</td>\n",
       "      <td>2.0</td>\n",
       "      <td>kimbg101</td>\n",
       "      <td>Gene Kimball</td>\n",
       "      <td>4.0</td>\n",
       "      <td>paboc101</td>\n",
       "      <td>Charlie Pabor</td>\n",
       "      <td>7.0</td>\n",
       "      <td>allia101</td>\n",
       "      <td>Art Allison</td>\n",
       "      <td>8.0</td>\n",
       "      <td>white104</td>\n",
       "      <td>Elmer White</td>\n",
       "      <td>9.0</td>\n",
       "      <td>prata101</td>\n",
       "      <td>Al Pratt</td>\n",
       "      <td>1.0</td>\n",
       "      <td>sutte101</td>\n",
       "      <td>Ezra Sutton</td>\n",
       "      <td>5.0</td>\n",
       "      <td>carlj102</td>\n",
       "      <td>Jim Carleton</td>\n",
       "      <td>3.0</td>\n",
       "      <td>bassj101</td>\n",
       "      <td>John Bass</td>\n",
       "      <td>6.0</td>\n",
       "      <td>mcatb101</td>\n",
       "      <td>Bub McAtee</td>\n",
       "      <td>3.0</td>\n",
       "      <td>kingm101</td>\n",
       "      <td>Marshall King</td>\n",
       "      <td>8.0</td>\n",
       "      <td>hodec101</td>\n",
       "      <td>Charlie Hodes</td>\n",
       "      <td>2.0</td>\n",
       "      <td>woodj106</td>\n",
       "      <td>Jimmy Wood</td>\n",
       "      <td>4.0</td>\n",
       "      <td>simmj101</td>\n",
       "      <td>Joe Simmons</td>\n",
       "      <td>9.0</td>\n",
       "      <td>folet101</td>\n",
       "      <td>Tom Foley</td>\n",
       "      <td>7.0</td>\n",
       "      <td>duffe101</td>\n",
       "      <td>Ed Duffy</td>\n",
       "      <td>6.0</td>\n",
       "      <td>pinke101</td>\n",
       "      <td>Ed Pinkham</td>\n",
       "      <td>5.0</td>\n",
       "      <td>zettg101</td>\n",
       "      <td>George Zettlein</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>18710509</td>\n",
       "      <td>0</td>\n",
       "      <td>Tue</td>\n",
       "      <td>BS1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>TRO</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>54.0</td>\n",
       "      <td>D</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>TRO01</td>\n",
       "      <td>3250.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>000002232</td>\n",
       "      <td>101003000</td>\n",
       "      <td>46.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>12.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>36.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>leroi901</td>\n",
       "      <td>Isaac Leroy</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>pikel101</td>\n",
       "      <td>Lip Pike</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>mcmuj101</td>\n",
       "      <td>John McMullin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>mcmuj101</td>\n",
       "      <td>John McMullin</td>\n",
       "      <td>wrigg101</td>\n",
       "      <td>George Wright</td>\n",
       "      <td>6.0</td>\n",
       "      <td>barnr102</td>\n",
       "      <td>Ross Barnes</td>\n",
       "      <td>4.0</td>\n",
       "      <td>birdd102</td>\n",
       "      <td>Dave Birdsall</td>\n",
       "      <td>9.0</td>\n",
       "      <td>mcvec101</td>\n",
       "      <td>Cal McVey</td>\n",
       "      <td>2.0</td>\n",
       "      <td>wrigh101</td>\n",
       "      <td>Harry Wright</td>\n",
       "      <td>8.0</td>\n",
       "      <td>goulc101</td>\n",
       "      <td>Charlie Gould</td>\n",
       "      <td>3.0</td>\n",
       "      <td>schah101</td>\n",
       "      <td>Harry Schafer</td>\n",
       "      <td>5.0</td>\n",
       "      <td>conef101</td>\n",
       "      <td>Fred Cone</td>\n",
       "      <td>7.0</td>\n",
       "      <td>spala101</td>\n",
       "      <td>Al Spalding</td>\n",
       "      <td>1.0</td>\n",
       "      <td>flync101</td>\n",
       "      <td>Clipper Flynn</td>\n",
       "      <td>9.0</td>\n",
       "      <td>mcgem101</td>\n",
       "      <td>Mike McGeary</td>\n",
       "      <td>2.0</td>\n",
       "      <td>yorkt101</td>\n",
       "      <td>Tom York</td>\n",
       "      <td>8.0</td>\n",
       "      <td>mcmuj101</td>\n",
       "      <td>John McMullin</td>\n",
       "      <td>1.0</td>\n",
       "      <td>kings101</td>\n",
       "      <td>Steve King</td>\n",
       "      <td>7.0</td>\n",
       "      <td>beave101</td>\n",
       "      <td>Edward Beavens</td>\n",
       "      <td>4.0</td>\n",
       "      <td>bells101</td>\n",
       "      <td>Steve Bellan</td>\n",
       "      <td>5.0</td>\n",
       "      <td>pikel101</td>\n",
       "      <td>Lip Pike</td>\n",
       "      <td>3.0</td>\n",
       "      <td>cravb101</td>\n",
       "      <td>Bill Craver</td>\n",
       "      <td>6.0</td>\n",
       "      <td>HTBF</td>\n",
       "      <td>Y</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       date  number_of_game day_of_week v_name v_league  v_game_number h_name  \\\n",
       "0  18710504               0         Thu    CL1      NaN              1    FW1   \n",
       "1  18710505               0         Fri    BS1      NaN              1    WS3   \n",
       "2  18710506               0         Sat    CL1      NaN              2    RC1   \n",
       "3  18710508               0         Mon    CL1      NaN              3    CH1   \n",
       "4  18710509               0         Tue    BS1      NaN              2    TRO   \n",
       "\n",
       "  h_league  h_game_number  v_score  h_score  length_outs day_night completion  \\\n",
       "0      NaN              1        0        2         54.0         D        NaN   \n",
       "1      NaN              1       20       18         54.0         D        NaN   \n",
       "2      NaN              1       12        4         54.0         D        NaN   \n",
       "3      NaN              1       12       14         54.0         D        NaN   \n",
       "4      NaN              1        9        5         54.0         D        NaN   \n",
       "\n",
       "  forefeit protest park_id  attendance  length_minutes v_line_score  \\\n",
       "0      NaN     NaN   FOR01       200.0           120.0    000000000   \n",
       "1      NaN     NaN   WAS01      5000.0           145.0    107000435   \n",
       "2      NaN     NaN   RCK01      1000.0           140.0    610020003   \n",
       "3      NaN     NaN   CHI01      5000.0           150.0    101403111   \n",
       "4      NaN     NaN   TRO01      3250.0           145.0    000002232   \n",
       "\n",
       "  h_line_score  v_at_bats  v_hits  v_doubles  v_triples  v_homeruns  v_rbi  \\\n",
       "0    010010000       30.0     4.0        1.0        0.0         0.0    0.0   \n",
       "1    640113030       41.0    13.0        1.0        2.0         0.0   13.0   \n",
       "2    010020100       49.0    11.0        1.0        1.0         0.0    8.0   \n",
       "3    077000000       46.0    15.0        2.0        1.0         2.0   10.0   \n",
       "4    101003000       46.0    17.0        4.0        1.0         0.0    6.0   \n",
       "\n",
       "   v_sacrifice_hits  v_sacrifice_flies  v_hit_by_pitch  v_walks  \\\n",
       "0               0.0                0.0             0.0      1.0   \n",
       "1               0.0                0.0             0.0     18.0   \n",
       "2               0.0                0.0             0.0      0.0   \n",
       "3               0.0                0.0             0.0      0.0   \n",
       "4               0.0                0.0             0.0      2.0   \n",
       "\n",
       "   v_intentional_walks  v_strikeouts  v_stolen_bases  v_caught_stealing  \\\n",
       "0                  NaN           6.0             1.0                NaN   \n",
       "1                  NaN           5.0             3.0                NaN   \n",
       "2                  NaN           1.0             0.0                NaN   \n",
       "3                  NaN           1.0             0.0                NaN   \n",
       "4                  NaN           0.0             1.0                NaN   \n",
       "\n",
       "   v_grounded_into_double  v_first_catcher_interference  v_left_on_base  \\\n",
       "0                    -1.0                           NaN             4.0   \n",
       "1                    -1.0                           NaN            12.0   \n",
       "2                    -1.0                           NaN            10.0   \n",
       "3                    -1.0                           NaN             7.0   \n",
       "4                    -1.0                           NaN            12.0   \n",
       "\n",
       "   v_pitchers_used  v_individual_earned_runs  v_team_earned_runs  \\\n",
       "0              1.0                       1.0                 1.0   \n",
       "1              1.0                       6.0                 6.0   \n",
       "2              1.0                       0.0                 0.0   \n",
       "3              1.0                       6.0                 6.0   \n",
       "4              1.0                       2.0                 2.0   \n",
       "\n",
       "   v_wild_pitches  v_balks  v_putouts  v_assists  v_errors  v_passed_balls  \\\n",
       "0             0.0      0.0       27.0        9.0       0.0             3.0   \n",
       "1             1.0      0.0       27.0       13.0      10.0             1.0   \n",
       "2             2.0      0.0       27.0       12.0       8.0             5.0   \n",
       "3             0.0      0.0       27.0       15.0      11.0             6.0   \n",
       "4             0.0      0.0       27.0       12.0       5.0             0.0   \n",
       "\n",
       "   v_double_plays  v_triple_plays  h_at_bats  h_hits  h_doubles  h_triples  \\\n",
       "0             0.0             0.0       31.0     4.0        1.0        0.0   \n",
       "1             2.0             0.0       49.0    14.0        2.0        0.0   \n",
       "2             0.0             0.0       36.0     7.0        2.0        1.0   \n",
       "3             0.0             0.0       43.0    11.0        2.0        0.0   \n",
       "4             1.0             0.0       36.0     9.0        0.0        0.0   \n",
       "\n",
       "   h_homeruns  h_rbi  h_sacrifice_hits  h_sacrifice_flies  h_hit_by_pitch  \\\n",
       "0         0.0    2.0               0.0                0.0             0.0   \n",
       "1         0.0   11.0               0.0                0.0             0.0   \n",
       "2         0.0    2.0               0.0                0.0             0.0   \n",
       "3         0.0    8.0               0.0                0.0             0.0   \n",
       "4         0.0    2.0               0.0                0.0             0.0   \n",
       "\n",
       "   h_walks  h_intentional_walks  h_strikeouts  h_stolen_bases  \\\n",
       "0      1.0                  NaN           0.0             0.0   \n",
       "1     10.0                  NaN           2.0             1.0   \n",
       "2      0.0                  NaN           3.0             5.0   \n",
       "3      4.0                  NaN           2.0             1.0   \n",
       "4      3.0                  NaN           0.0             2.0   \n",
       "\n",
       "   h_caught_stealing  h_grounded_into_double  h_first_catcher_interference  \\\n",
       "0                NaN                    -1.0                           NaN   \n",
       "1                NaN                    -1.0                           NaN   \n",
       "2                NaN                    -1.0                           NaN   \n",
       "3                NaN                    -1.0                           NaN   \n",
       "4                NaN                    -1.0                           NaN   \n",
       "\n",
       "   h_left_on_base  h_pitchers_used  h_individual_earned_runs  \\\n",
       "0             3.0              1.0                       0.0   \n",
       "1            14.0              1.0                       7.0   \n",
       "2             5.0              1.0                       3.0   \n",
       "3             6.0              1.0                       4.0   \n",
       "4             7.0              1.0                       3.0   \n",
       "\n",
       "   h_team_earned_runs  h_wild_pitches  h_balks  h_putouts  h_assists  \\\n",
       "0                 0.0             0.0      0.0       27.0        3.0   \n",
       "1                 7.0             0.0      0.0       27.0       20.0   \n",
       "2                 3.0             1.0      0.0       27.0       12.0   \n",
       "3                 4.0             0.0      0.0       27.0       14.0   \n",
       "4                 3.0             1.0      0.0       27.0       11.0   \n",
       "\n",
       "   h_errors  h_passed_balls  h_double_plays  h_triple_plays hp_umpire_id  \\\n",
       "0       3.0             1.0             1.0             0.0     boakj901   \n",
       "1      10.0             2.0             3.0             0.0     dobsh901   \n",
       "2      13.0             3.0             0.0             0.0     mawnj901   \n",
       "3       7.0             2.0             0.0             0.0     willg901   \n",
       "4       7.0             3.0             0.0             0.0     leroi901   \n",
       "\n",
       "    hp_umpire_name 1b_umpire_id 1b_umpire_name 2b_umpire_id 2b_umpire_name  \\\n",
       "0       John Boake          NaN            NaN          NaN            NaN   \n",
       "1     Henry Dobson          NaN            NaN          NaN            NaN   \n",
       "2       J.H. Manny          NaN            NaN          NaN            NaN   \n",
       "3  Gardner Willard          NaN            NaN          NaN            NaN   \n",
       "4      Isaac Leroy          NaN            NaN          NaN            NaN   \n",
       "\n",
       "  3b_umpire_id 3b_umpire_name lf_umpire_id lf_umpire_name rf_umpire_id  \\\n",
       "0          NaN            NaN          NaN            NaN          NaN   \n",
       "1          NaN            NaN          NaN            NaN          NaN   \n",
       "2          NaN            NaN          NaN            NaN          NaN   \n",
       "3          NaN            NaN          NaN            NaN          NaN   \n",
       "4          NaN            NaN          NaN            NaN          NaN   \n",
       "\n",
       "  rf_umpire_name v_manager_id v_manager_name h_manager_id  h_manager_name  \\\n",
       "0            NaN     paboc101  Charlie Pabor     lennb101     Bill Lennon   \n",
       "1            NaN     wrigh101   Harry Wright     younn801      Nick Young   \n",
       "2            NaN     paboc101  Charlie Pabor     hasts101  Scott Hastings   \n",
       "3            NaN     paboc101  Charlie Pabor     woodj106      Jimmy Wood   \n",
       "4            NaN     wrigh101   Harry Wright     pikel101        Lip Pike   \n",
       "\n",
       "  winning_pitcher_id winning_pitcher_name losing_pitcher_id  \\\n",
       "0           mathb101        Bobby Mathews          prata101   \n",
       "1           spala101          Al Spalding          braia102   \n",
       "2           prata101             Al Pratt          fishc102   \n",
       "3           zettg101      George Zettlein          prata101   \n",
       "4           spala101          Al Spalding          mcmuj101   \n",
       "\n",
       "  losing_pitcher_name saving_pitcher_id saving_pitcher_name  \\\n",
       "0            Al Pratt               NaN                 NaN   \n",
       "1        Asa Brainard               NaN                 NaN   \n",
       "2     Cherokee Fisher               NaN                 NaN   \n",
       "3            Al Pratt               NaN                 NaN   \n",
       "4       John McMullin               NaN                 NaN   \n",
       "\n",
       "  winning_rbi_batter_id winning_rbi_batter_id_name v_starting_pitcher_id  \\\n",
       "0                   NaN                        NaN              prata101   \n",
       "1                   NaN                        NaN              spala101   \n",
       "2                   NaN                        NaN              prata101   \n",
       "3                   NaN                        NaN              prata101   \n",
       "4                   NaN                        NaN              spala101   \n",
       "\n",
       "  v_starting_pitcher_name h_starting_pitcher_id h_starting_pitcher_name  \\\n",
       "0                Al Pratt              mathb101           Bobby Mathews   \n",
       "1             Al Spalding              braia102            Asa Brainard   \n",
       "2                Al Pratt              fishc102         Cherokee Fisher   \n",
       "3                Al Pratt              zettg101         George Zettlein   \n",
       "4             Al Spalding              mcmuj101           John McMullin   \n",
       "\n",
       "  v_player_1_id v_player_1_name  v_player_1_def_pos v_player_2_id  \\\n",
       "0      whitd102    Deacon White                 2.0      kimbg101   \n",
       "1      wrigg101   George Wright                 6.0      barnr102   \n",
       "2      whitd102    Deacon White                 2.0      kimbg101   \n",
       "3      whitd102    Deacon White                 2.0      kimbg101   \n",
       "4      wrigg101   George Wright                 6.0      barnr102   \n",
       "\n",
       "  v_player_2_name  v_player_2_def_pos v_player_3_id v_player_3_name  \\\n",
       "0    Gene Kimball                 4.0      paboc101   Charlie Pabor   \n",
       "1     Ross Barnes                 4.0      birdd102   Dave Birdsall   \n",
       "2    Gene Kimball                 4.0      paboc101   Charlie Pabor   \n",
       "3    Gene Kimball                 4.0      paboc101   Charlie Pabor   \n",
       "4     Ross Barnes                 4.0      birdd102   Dave Birdsall   \n",
       "\n",
       "   v_player_3_def_pos v_player_4_id v_player_4_name  v_player_4_def_pos  \\\n",
       "0                 7.0      allia101     Art Allison                 8.0   \n",
       "1                 9.0      mcvec101       Cal McVey                 2.0   \n",
       "2                 7.0      allia101     Art Allison                 8.0   \n",
       "3                 7.0      allia101     Art Allison                 8.0   \n",
       "4                 9.0      mcvec101       Cal McVey                 2.0   \n",
       "\n",
       "  v_player_5_id v_player_5_name  v_player_5_def_pos v_player_6_id  \\\n",
       "0      white104     Elmer White                 9.0      prata101   \n",
       "1      wrigh101    Harry Wright                 8.0      goulc101   \n",
       "2      white104     Elmer White                 9.0      prata101   \n",
       "3      white104     Elmer White                 9.0      prata101   \n",
       "4      wrigh101    Harry Wright                 8.0      goulc101   \n",
       "\n",
       "  v_player_6_name  v_player_6_def_pos v_player_7_id v_player_7_name  \\\n",
       "0        Al Pratt                 1.0      sutte101     Ezra Sutton   \n",
       "1   Charlie Gould                 3.0      schah101   Harry Schafer   \n",
       "2        Al Pratt                 1.0      sutte101     Ezra Sutton   \n",
       "3        Al Pratt                 1.0      sutte101     Ezra Sutton   \n",
       "4   Charlie Gould                 3.0      schah101   Harry Schafer   \n",
       "\n",
       "   v_player_7_def_pos v_player_8_id v_player_8_name  v_player_8_def_pos  \\\n",
       "0                 5.0      carlj102    Jim Carleton                 3.0   \n",
       "1                 5.0      conef101       Fred Cone                 7.0   \n",
       "2                 5.0      carlj102    Jim Carleton                 3.0   \n",
       "3                 5.0      carlj102    Jim Carleton                 3.0   \n",
       "4                 5.0      conef101       Fred Cone                 7.0   \n",
       "\n",
       "  v_player_9_id v_player_9_name  v_player_9_def_pos h_player_1_id  \\\n",
       "0      bassj101       John Bass                 6.0      selmf101   \n",
       "1      spala101     Al Spalding                 1.0      watef102   \n",
       "2      bassj101       John Bass                 6.0      mackd101   \n",
       "3      bassj101       John Bass                 6.0      mcatb101   \n",
       "4      spala101     Al Spalding                 1.0      flync101   \n",
       "\n",
       "  h_player_1_name  h_player_1_def_pos h_player_2_id h_player_2_name  \\\n",
       "0   Frank Sellman                 5.0      mathb101   Bobby Mathews   \n",
       "1   Fred Waterman                 5.0      forcd101      Davy Force   \n",
       "2      Denny Mack                 3.0      addyb101        Bob Addy   \n",
       "3      Bub McAtee                 3.0      kingm101   Marshall King   \n",
       "4   Clipper Flynn                 9.0      mcgem101    Mike McGeary   \n",
       "\n",
       "   h_player_2_def_pos h_player_3_id  h_player_3_name  h_player_3_def_pos  \\\n",
       "0                 1.0      foraj101        Jim Foran                 3.0   \n",
       "1                 6.0      mille105    Everett Mills                 3.0   \n",
       "2                 4.0      fishc102  Cherokee Fisher                 1.0   \n",
       "3                 8.0      hodec101    Charlie Hodes                 2.0   \n",
       "4                 2.0      yorkt101         Tom York                 8.0   \n",
       "\n",
       "  h_player_4_id  h_player_4_name  h_player_4_def_pos h_player_5_id  \\\n",
       "0      goldw101  Wally Goldsmith                 6.0      lennb101   \n",
       "1      allid101     Doug Allison                 2.0      hallg101   \n",
       "2      hasts101   Scott Hastings                 8.0      ham-r101   \n",
       "3      woodj106       Jimmy Wood                 4.0      simmj101   \n",
       "4      mcmuj101    John McMullin                 1.0      kings101   \n",
       "\n",
       "  h_player_5_name  h_player_5_def_pos h_player_6_id h_player_6_name  \\\n",
       "0     Bill Lennon                 2.0      caret101       Tom Carey   \n",
       "1     George Hall                 7.0      leona101    Andy Leonard   \n",
       "2       Ralph Ham                 5.0      ansoc101       Cap Anson   \n",
       "3     Joe Simmons                 9.0      folet101       Tom Foley   \n",
       "4      Steve King                 7.0      beave101  Edward Beavens   \n",
       "\n",
       "   h_player_6_def_pos h_player_7_id h_player_7_name  h_player_7_def_pos  \\\n",
       "0                 4.0      mince101      Ed Mincher                 7.0   \n",
       "1                 4.0      braia102    Asa Brainard                 1.0   \n",
       "2                 2.0      sagep101      Pony Sager                 6.0   \n",
       "3                 7.0      duffe101        Ed Duffy                 6.0   \n",
       "4                 4.0      bells101    Steve Bellan                 5.0   \n",
       "\n",
       "  h_player_8_id  h_player_8_name  h_player_8_def_pos h_player_9_id  \\\n",
       "0      mcdej101  James McDermott                 8.0      kellb105   \n",
       "1      burrh101  Henry Burroughs                 9.0      berth101   \n",
       "2      birdg101      George Bird                 7.0      stirg101   \n",
       "3      pinke101       Ed Pinkham                 5.0      zettg101   \n",
       "4      pikel101         Lip Pike                 3.0      cravb101   \n",
       "\n",
       "   h_player_9_name  h_player_9_def_pos additional_info acquisition_info  \n",
       "0       Bill Kelly                 9.0             NaN                Y  \n",
       "1  Henry Berthrong                 8.0            HTBF                Y  \n",
       "2       Gat Stires                 9.0             NaN                Y  \n",
       "3  George Zettlein                 1.0             NaN                Y  \n",
       "4      Bill Craver                 6.0            HTBF                Y  "
      ]
     },
     "execution_count": 138,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "game_log.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 143,
   "metadata": {
    "collapsed": false
   },
   "outputs": [],
   "source": [
    "c17 = '''\n",
    "INSERT OR IGNORE INTO person_appearance (\n",
    "    game_id,\n",
    "    team_id,\n",
    "    person_id,\n",
    "    appearance_type_id\n",
    ")\n",
    "    SELECT\n",
    "        game_id,\n",
    "        NULL,\n",
    "        hp_umpire_id,\n",
    "        'UHP'\n",
    "    FROM game_log\n",
    "    WHERE hp_umpire_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "    SELECT\n",
    "        game_id,\n",
    "        NULL,\n",
    "        [1b_umpire_id],\n",
    "        'U1B'\n",
    "    FROM game_log\n",
    "    WHERE [1b_umpire_id] IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        NULL,\n",
    "        [2b_umpire_id],\n",
    "        'U2B'\n",
    "    FROM game_log\n",
    "    WHERE [2b_umpire_id] IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "    SELECT\n",
    "        game_id,\n",
    "        NULL,\n",
    "        [3b_umpire_id],\n",
    "        'U3B'\n",
    "    FROM game_log\n",
    "    WHERE [3b_umpire_id] IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        NULL,\n",
    "        lf_umpire_id,\n",
    "        'ULF'\n",
    "    FROM game_log\n",
    "    WHERE lf_umpire_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        NULL,\n",
    "        rf_umpire_id,\n",
    "        'URF'\n",
    "    FROM game_log\n",
    "    WHERE rf_umpire_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        v_name,\n",
    "        v_manager_id,\n",
    "        'MM'\n",
    "    FROM game_log\n",
    "    WHERE v_manager_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        h_name,\n",
    "        h_manager_id,\n",
    "        'MM'\n",
    "    FROM game_log\n",
    "    WHERE h_manager_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        CASE\n",
    "            WHEN h_score > v_score THEN h_name\n",
    "            ELSE v_name\n",
    "            END,\n",
    "        winning_pitcher_id,\n",
    "        'AWP'\n",
    "    FROM game_log\n",
    "    WHERE winning_pitcher_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "    \n",
    "    SELECT\n",
    "        game_id,\n",
    "        CASE\n",
    "            WHEN h_score > v_score THEN v_name\n",
    "            ELSE h_name\n",
    "            END,\n",
    "        losing_pitcher_id,\n",
    "        'ALP'\n",
    "    FROM game_log\n",
    "    WHERE losing_pitcher_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        CASE\n",
    "            WHEN h_score > v_score THEN h_name\n",
    "            ELSE v_name\n",
    "            END,\n",
    "        saving_pitcher_id,\n",
    "        'ASP'\n",
    "    FROM game_log\n",
    "    WHERE saving_pitcher_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        CASE\n",
    "            WHEN h_score > v_score THEN h_name\n",
    "            ELSE v_name\n",
    "            END,\n",
    "        winning_rbi_batter_id,\n",
    "        'AWB'\n",
    "    FROM game_log\n",
    "    WHERE winning_rbi_batter_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        v_name,\n",
    "        v_starting_pitcher_id,\n",
    "        'PSP'\n",
    "    FROM game_log\n",
    "    WHERE v_starting_pitcher_id IS NOT NULL\n",
    "    \n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        h_name,\n",
    "        h_starting_pitcher_id,\n",
    "        'PSP'\n",
    "    FROM game_log\n",
    "    WHERE h_starting_pitcher_id IS NOT NULL\n",
    ";'''\n",
    "\n",
    "run_command(c17)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 144,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "c18 = \"\"\"\n",
    "INSERT INTO person_appearance (\n",
    "    game_id,\n",
    "    team_id,\n",
    "    person_id,\n",
    "    appearance_type_id\n",
    ") \n",
    "    SELECT\n",
    "        game_id,\n",
    "        {hv}_name,\n",
    "        {hv}_player_{num}_id,\n",
    "        \"O{num}\"\n",
    "    FROM game_log\n",
    "    WHERE {hv}_player_{num}_id IS NOT NULL\n",
    "\n",
    "UNION\n",
    "\n",
    "    SELECT\n",
    "        game_id,\n",
    "        {hv}_name,\n",
    "        {hv}_player_{num}_id,\n",
    "        \"D\" || CAST({hv}_player_{num}_def_pos AS INT)\n",
    "    FROM game_log\n",
    "    WHERE {hv}_player_{num}_id IS NOT NULL;\n",
    "\"\"\"\n",
    "for hv in [\"h\", \"v\"]:\n",
    "    for num in range(1,10):\n",
    "        query_vars = {\n",
    "            \"hv\": hv,\n",
    "            \"num\": num\n",
    "        }\n",
    "run_command(c18.format(**query_vars))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   COUNT(DISTINCT(game_id))\n",
      "0                    171907\n",
      "   COUNT(DISTINCT(game_id))\n",
      "0                    171907\n"
     ]
    }
   ],
   "source": [
    "print(run_query('SELECT COUNT(DISTINCT(game_id)) FROM person_appearance'))\n",
    "print(run_query('SELECT COUNT(DISTINCT(game_id)) FROM game_log'))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>park</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>league</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>team_apperance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>person</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>team</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>game</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>team_appearance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>game_log</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>park_codes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>person_codes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>team_codes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>appearance_type</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>appearance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>person_appearance</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 type\n",
       "0                park\n",
       "1              league\n",
       "2      team_apperance\n",
       "3              person\n",
       "4                team\n",
       "5                game\n",
       "6     team_appearance\n",
       "7            game_log\n",
       "8          park_codes\n",
       "9        person_codes\n",
       "10         team_codes\n",
       "11    appearance_type\n",
       "12         appearance\n",
       "13  person_appearance"
      ]
     },
     "execution_count": 153,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "show_tables()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "metadata": {
    "collapsed": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>park</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>league</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>person</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>team</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>game</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>team_appearance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>appearance_type</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>appearance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>person_appearance</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                type\n",
       "0               park\n",
       "1             league\n",
       "2             person\n",
       "3               team\n",
       "4               game\n",
       "5    team_appearance\n",
       "6    appearance_type\n",
       "7         appearance\n",
       "8  person_appearance"
      ]
     },
     "execution_count": 154,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tables = [\n",
    "    'game_log',\n",
    "    'park_codes',\n",
    "    'team_codes',\n",
    "    'person_codes',\n",
    "    'team_apperance'\n",
    "]\n",
    "\n",
    "for t in tables:\n",
    "    c = 'DROP TABLE {}'.format(t)\n",
    "    run_command(c)\n",
    "\n",
    "show_tables()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Data has now been normalized into the 8 tables show above and the orginal non-normalized tables have been removed. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.4.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
